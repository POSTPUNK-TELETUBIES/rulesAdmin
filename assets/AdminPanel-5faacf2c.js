import{j as e,af as Ie,ag as Me,a6 as De,ah as Pe,ad as Te,ai as Le,aj as re,ak as Ae,al as Fe,am as Re,an as Ee,ao as Oe}from"./@mui/icons-material-b88151fa.js";import{r as o,d as W,e as qe}from"./vendor-b612640b.js";import{f as ie,s as He,v as Be,D as Ne,u as le,a as Z,b as Ye,c as ze,d as Ve,A as oe,e as I,C as ee,g as $e,h as Qe,i as We,p as Ge,j as Ke,k as Ue,l as Je,S as Xe,m as Ze,n as te}from"./index-4ec075fb.js";import{u as et}from"./@reactour/tour-e24be7d6.js";import{u as ce}from"./@tanstack/react-query-7cfe65c4.js";import{F as A,I as F,x as R,M as p,y as tt,r as de,h as T,i as C,S as g,q as ue,B as v,z as nt,E as he,G as ne,H as P,J as st,s as at,K as S,N as rt,L as xe,e as fe,Q as it}from"./@mui/material-d4ab1316.js";import{D as E,s as O,b as f,C as k,E as G,H as lt,J as ot,M as ct,N as dt,O as ut,Q as ht,R as xt,U as ft,V as gt,x as mt}from"./@mui/lab-d8569c0b.js";import{d as pt,a as y}from"./dayjs-c0cd33fe.js";import{c as jt,o as vt}from"./use-debounce-6bf2a1da.js";import{c as Ct}from"./react-draggable-25144dc2.js";import{u as bt}from"./react-hook-form-c6612ec3.js";import"./@emotion/react-0d101b94.js";import"./@emotion/styled-6b07d811.js";import"./@supabase/supabase-js-711ba96a.js";import"./dexie-3976de5d.js";import"./dexie-react-hooks-0c2ddb12.js";import"./axios-760d4776.js";import"./papaparse-e84842e1.js";import"./@react-rxjs/utils-24ca515a.js";import"./@react-rxjs/core-1a0bb4f0.js";import"./notistack-f20782e6.js";import"./hotkeys-js-d20e5801.js";var ge=(t=>(t.Blocker="BLOCKER",t.Critical="CRITICAL",t.Info="INFO",t.Major="MAJOR",t.Minor="MINOR",t))(ge||{}),me=(t=>(t.Bug="BUG",t.CodeSmell="CODE_SMELL",t.SecurityHotspot="SECURITY_HOTSPOT",t.Vulnerability="VULNERABILITY",t))(me||{});const yt=()=>{const{data:t,isLoading:n}=ce({queryKey:["languages"],queryFn:()=>ie.getAllLanguages()});return{data:t,isLoading:n}},pe=t=>{const{data:n,isFetching:s}=ce({queryKey:["qualityprofile",t],queryFn:()=>ie.getQualityProfilesByLanguage(t),enabled:!!t});return{data:n,isFetching:s}},je=({className:t,handleChange:n,inputProps:s,includeAllOption:a,displayEmpty:l})=>{const{data:r,isLoading:i}=yt();return e.jsx(A,{sx:{width:200},className:t,children:i?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsx(F,{id:"language",children:"Lenguaje"}),e.jsxs(R,{inputProps:s,labelId:"language",label:"Lenguaje",onChange:n,sx:{width:200},defaultValue:a?"all":"",displayEmpty:l,children:[a&&e.jsx(p,{value:"all",children:"Todos"}),r==null?void 0:r.map(({id:u,name:h})=>e.jsx(p,{value:u,children:h},u))]})]})})},_t=()=>{const{setIsOpen:t,isOpen:n}=et(),s=o.useCallback(a=>{He(a.target.value)},[]);return o.useEffect(()=>{const a=Be();t(a)},[t]),o.useEffect(()=>{Ne("body",n==null?void 0:n.valueOf())},[n]),e.jsx(je,{className:"language",handleChange:s,displayEmpty:!0})},St=()=>{const t=le(),n=o.useRef(null),{data:s,isFetching:a}=pe(t);o.useEffect(()=>{var r;Z(((r=n.current)==null?void 0:r.value)??"")},[t]);const l=o.useCallback(r=>{Z(r.target.value)},[]);return a?e.jsx(E,{}):e.jsxs(A,{className:"mainFilters",sx:{width:200},children:[e.jsx(F,{id:"qualityprofile",children:"Quality Profile"}),e.jsx(R,{ref:n,onChange:l,label:"Quality Profile",labelId:"qualityprofile",defaultValue:"",displayEmpty:!0,children:s==null?void 0:s.map(({id:r,name:i})=>e.jsx(p,{value:r,children:i},r))})]})},kt=({value:t,label:n,reactiveCb:s})=>{const a=o.useCallback(()=>{s(t)},[s,t]);return e.jsx(p,{onClick:a,children:n})},K=({filterConfig:t,reactiveCallback:n,isClosingRecursive:s})=>{const[a,l]=o.useState(null),[r,i]=o.useState(!0),u=o.useCallback(c=>{n(c),i(c==="all"),s&&l(null)},[s,n]),h=o.useCallback(()=>{l(null)},[]),d=o.useCallback(c=>{c.preventDefault(),l(c.currentTarget)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(O,{onClick:d,sx:{padding:"1px !important"},children:e.jsx(tt,{variant:"dot",invisible:r,color:"secondary",children:e.jsx(Ie,{sx:{color:"#e4a010"}})})}),e.jsx(de,{anchorEl:a,onClose:h,open:!!a,children:t.map(({value:c,label:x})=>e.jsx(kt,{label:x,value:c,reactiveCb:u}))})]})},ve=[{value:"all",label:"Todos"},...Object.values(me).map(t=>({value:t,label:t}))],Ce=[{value:"all",label:"Todos"},...Object.values(ge).map(t=>({value:t,label:t}))],be=[{value:"all",label:"Todos"},{value:"active",label:"Activo"},{value:"deactive",label:"Inactivo"}],wt=Object.freeze({all:null,active:!0,deactive:!1}),It=()=>{const t=o.useCallback(n=>{Ye(wt[n])},[]);return e.jsx(K,{filterConfig:be,isClosingRecursive:!0,reactiveCallback:t})},Mt=()=>{const t=o.useCallback(n=>{ze(n)},[]);return e.jsx(K,{filterConfig:Ce,isClosingRecursive:!0,reactiveCallback:t})},Dt=()=>{const t=o.useCallback(n=>Ve(n),[]);return e.jsx(K,{filterConfig:ve,isClosingRecursive:!0,reactiveCallback:t})},w=[{label:"",especialConfig:!0,resource:"htmlDesc"},{label:"Código",resource:"key",textAlign:"left"},{label:"Regla",resource:"name",textAlign:"left"},{label:"Tipo",resource:"type",filter:e.jsx(Dt,{}),textAlign:"left"},{label:"Severidad",resource:"severity",textAlign:"left",filter:e.jsx(Mt,{})},{label:"E. Actual",resource:"isActiveSonar",especialConfig:!0,className:"actualState",textAlign:"left",filter:e.jsx(It,{}),sxProps:{minWidth:100}},{label:"E. Propuesto",resource:"isActive",especialConfig:!0,className:"proposedState",sxProps:{minWidth:100}},{label:"Propuesta",resource:"updated_at",especialConfig:!0,icon:e.jsx(Me,{sx:{color:t=>t.palette.common.white}})},{label:"Autor",resource:"user_email",sxProps:{width:150}}],Pt=o.memo(({data:t})=>e.jsx(e.Fragment,{children:e.jsx(T,{children:t.map(({label:n,icon:s,filter:a,className:l,sxProps:r})=>e.jsx(C,{variant:"head",className:l,sx:{background:i=>`${i.palette.grey[900]} !important`,...r},children:e.jsxs(g,{direction:"row",gap:.5,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{sx:{color:i=>i.palette.common.white},fontWeight:700,children:n}),s,a]})},n))})}));var $={},Tt={get exports(){return $},set exports(t){$=t}};(function(t,n){(function(s,a){t.exports=a()})(W,function(){return function(s,a,l){l.updateLocale=function(r,i){var u=l.Ls[r];if(u)return(i?Object.keys(i):[]).forEach(function(h){u[h]=i[h]}),u}}})})(Tt);const Lt=$;var Q={},At={get exports(){return Q},set exports(t){Q=t}};(function(t,n){(function(s,a){t.exports=a()})(W,function(){return function(s,a,l){s=s||{};var r=a.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function u(d,c,x,m){return r.fromToBase(d,c,x,m)}l.en.relativeTime=i,r.fromToBase=function(d,c,x,m,M){for(var q,D,H,B=x.$locale().relativeTime||i,N=s.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],we=N.length,_=0;_<we;_+=1){var j=N[_];j.d&&(q=m?l(d).diff(x,j.d,!0):x.diff(d,j.d,!0));var b=(s.rounding||Math.round)(Math.abs(q));if(H=q>0,b<=j.r||!j.r){b<=1&&_>0&&(j=N[_-1]);var Y=B[j.l];M&&(b=M(""+b)),D=typeof Y=="string"?Y.replace("%d",b):Y(b,c,j.l,H);break}}if(c)return D;var z=H?B.future:B.past;return typeof z=="function"?z(D):z.replace("%s",D)},r.to=function(d,c){return u(d,c,this,!0)},r.from=function(d,c){return u(d,c,this)};var h=function(d){return d.$u?l.utc():l()};r.toNow=function(d){return this.to(h(this),d)},r.fromNow=function(d){return this.from(h(this),d)}}})})(At);const Ft=Q;var se={},Rt={get exports(){return se},set exports(t){se=t}};(function(t,n){(function(s,a){t.exports=a(pt)})(W,function(s){function a(i){return i&&typeof i=="object"&&"default"in i?i:{default:i}}var l=a(s),r={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(i){return i+"º"}};return l.default.locale(r,null,!0),r})})(Rt);y.extend(Lt);y.locale("es");y.extend(Ft);y.updateLocale("es",{relativeTime:{future:"en %s",past:"hace %s",s:"1 s",m:"1 min",mm:"%d min",h:"1 h",hh:"%d h",d:"1 d",dd:"%d d",M:"1 M",MM:"%d M",y:"1 Y",yy:"%d Y"}});const Et=({date:t})=>e.jsx(f,{align:"left",children:y(t).from(new Date)}),U=o.createContext({isDisabled:!0,setIsDisabled:()=>{}}),Ot=({children:t})=>{const[n,s]=o.useState(!1),a=o.useMemo(()=>({isDisabled:n,setIsDisabled:s}),[n]);return e.jsx(U.Provider,{value:a,children:t})};function qt({initialStatus:t,result:n,id:s}){const[a,l]=o.useState(!1),[r,i]=o.useState(t),{setIsDisabled:u}=o.useContext(U),{user:h}=o.useContext(oe);o.useEffect(()=>{i(t)},[t]),o.useEffect(()=>{I.rulesStatus.get(Number(s)).then(x=>l(!!x))},[s]);const d=n.isActiveOriginal!==r;o.useEffect(()=>{a&&n.isActiveOriginal===r&&I.rulesStatus.delete(Number(s))},[r,s,a,n.isActiveOriginal]);const c=o.useCallback(async x=>{i(x.target.checked),u(!x.target.checked);const m=await I.rulesStatus.get(Number(s));(!a||n.isActiveOriginal!==x.target.checked)&&await I.rulesStatus.put({...m,id:Number(s),newStatus:x.target.checked,updated_at:new Date,languageId:n.lang_id,qualityProfileId:Number(n.qualityProfile_id),user_email:h==null?void 0:h.email}),l(!0)},[s,a,n.isActiveOriginal,n.lang_id,n.qualityProfile_id,h==null?void 0:h.email,u]);return e.jsxs(g,{direction:"row",alignItems:"center",children:[e.jsx(f,{minWidth:60,children:r?"Activo":"Inactivo"}),e.jsx(ue,{onChange:c,checked:r}),a&&d?e.jsx(De,{}):""]})}function Ht(t){const{tags:n,isActive:s,dateSonar:a,ruleTitle:l,ruleDescription:r}=t;return e.jsxs(v,{children:[e.jsxs(g,{padding:2,direction:"column",spacing:2,children:[e.jsxs(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(k,{sx:{backgroundColor:({palette:i})=>i.mode===ee.DARK?i.grey[900]:i.grey[800],color:"white"},label:`Regla ${s?"activo":"inactivo"} desde:`}),e.jsx(k,{label:`${a??"Sin info"}`})]}),e.jsx(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:n.map(i=>e.jsx(k,{label:i},i))})]}),e.jsx(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",padding:2,pb:0,children:e.jsx(G,{title:l,children:e.jsx(k,{color:"secondary",label:e.jsx(f,{noWrap:!0,variant:"h5",children:l})})})}),e.jsxs(g,{direction:"column",justifyContent:"center",padding:2,children:[e.jsx(g,{direction:"row",justifyContent:"flex-start",children:e.jsx(k,{label:"Descripción de la Regla",sx:{backgroundColor:({palette:i})=>i.mode===ee.DARK?i.grey[900]:i.grey[800],color:"white"}})}),e.jsx(f,{dangerouslySetInnerHTML:{__html:r}})]})]})}var J={},L={},Bt={get exports(){return L},set exports(t){L=t}};(function(t){function n(s){return s&&s.__esModule?s:{default:s}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Bt);var V={};const Nt=qe(Pe);var ae;function ye(){return ae||(ae=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=Nt}(V)),V}var Yt=L;Object.defineProperty(J,"__esModule",{value:!0});var _e=J.default=void 0,zt=Yt(ye()),Vt=e,$t=(0,zt.default)((0,Vt.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"History");_e=J.default=$t;function Qt({comments:t}){return e.jsx(lt,{sx:{[`& .${ot.root}:before`]:{flex:0,padding:0}},children:t.map(n=>e.jsxs(ct,{children:[e.jsxs(dt,{children:[e.jsx(ut,{color:"primary",children:e.jsx(_e,{})}),e.jsx(ht,{})]}),e.jsx(xt,{children:e.jsxs(v,{sx:{textAlign:"left"},children:[e.jsx(f,{variant:"subtitle2",sx:{fontSize:"1rem",fontWeight:"bold",color:"black"},children:n.timestamp}),e.jsx(f,{variant:"body1",children:n.author}),e.jsx(f,{variant:"body1",children:n.content})]})})]},n.id))})}var X={},Wt=L;Object.defineProperty(X,"__esModule",{value:!0});var Se=X.default=void 0,Gt=Wt(ye()),Kt=e,Ut=(0,Gt.default)((0,Kt.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");Se=X.default=Ut;const ke=({title:t,result:n})=>{const{user:s}=o.useContext(oe),a=jt(async({target:r})=>await I.saveDescription({...n,user_email:s==null?void 0:s.email},r.value),500),l=()=>{};return e.jsxs(e.Fragment,{children:[e.jsx(f,{sx:{fontStyle:"italic",fontWeight:900},children:"Sustento de la propuesta"}),e.jsx(nt,{multiline:!0,fullWidth:!0,defaultValue:n.description,title:t,placeholder:"Esta regla aún no ha tenido observaciones",onChange:a}),e.jsx(G,{title:"Editar propuesta",children:e.jsx(O,{onClick:l,sx:{background:({palette:r})=>r.primary.light,zIndex:500},children:e.jsx(Se,{})})})]})},Jt=[{tab:"description",content:({result:t})=>e.jsx(Ht,{tags:[t.severity,t.type],isActive:t.isActive,ruleTitle:t.name,ruleDescription:t.htmlDesc})},{tab:"history",content:()=>{const t=$e(8);return e.jsxs(v,{height:"100%",display:"flex",flexDirection:"column",children:[e.jsx(v,{flexGrow:1,overflow:"auto",flexBasis:"75%",children:e.jsx(Qt,{comments:t})}),e.jsx(P,{}),e.jsx(v,{height:"30%",overflow:"auto",p:2,children:e.jsx(g,{direction:"row",pr:2,children:e.jsx(ke,{result:{id:"1",created_at:new Date,isActive:!0,isActiveSonar:!1,qualityProfile_id:"profile-id",rule_id:"rule-id",updated_at:new Date,key:"rule-key",lang_id:"language-id",name:"rule-name",user_email:"user@example.com"},title:"Sustento de la propuesta"})})})]})}}],Xt=({isDrawerOpen:t,setIsDrawerOpen:n,result:s})=>{const[a,l]=o.useState("");o.useEffect(()=>{t||l("")},[t]);const r=d=>{d.stopPropagation(),n(!t),a==="description"&&l("")},i=(d,c)=>{l(c)},u=d=>{d.stopPropagation()},h=Jt.find(d=>d.tab===a);return e.jsxs(he,{anchor:"right",open:t,onClose:r,onClick:u,PaperProps:{style:{width:"42.5%"}},children:[e.jsxs(ft,{value:a,onChange:i,variant:"fullWidth","aria-label":"Drawer tabs",children:[e.jsx(ne,{label:"Descripción de Reglas",value:"description"}),e.jsx(ne,{label:"Historial de Cambios",value:"history"})]}),h&&h.content({result:s})]})},Zt=({resource:t,value:n,result:s,secondaryValue:a})=>{const[l,r]=o.useState(!1),i=()=>{r(!l)};return t==="isActiveSonar"?e.jsx(f,{children:n?"Activo":"Inactivo"}):t==="htmlDesc"?e.jsxs(e.Fragment,{children:[e.jsx(O,{onClick:i,children:e.jsx(Te,{})}),e.jsx(Xt,{isDrawerOpen:l,setIsDrawerOpen:r,result:s})]}):t==="updated_at"?Math.abs(y(String(n)).diff(a,"hours"))>6?e.jsx(Et,{date:String(n)}):e.jsx(f,{align:"left",children:"--"}):e.jsx(qt,{initialStatus:!!n,result:s,id:s.id})},en=({colSpan:t})=>e.jsx(C,{colSpan:t,children:e.jsx(v,{display:"grid",sx:{placeContent:"center",minHeight:400},children:e.jsx(E,{})})}),tn=({icon:t,primaryText:n,secondaryText:s})=>e.jsxs(g,{direction:"column",justifyContent:"center",alignItems:"center",minHeight:"50vh",sx:{fontSize:100},gap:8,children:[t,e.jsxs(g,{direction:"column",gap:4,children:[e.jsx(f,{color:"GrayText",variant:"h3",children:n}),s&&e.jsx(f,{textAlign:"center",color:"GrayText",variant:"body1",children:s})]})]}),nn=({hasContent:t,children:n,colSpan:s})=>t?e.jsx(e.Fragment,{children:n}):e.jsx(T,{children:e.jsx(C,{colSpan:s,children:e.jsx(tn,{icon:e.jsx(Le,{color:"disabled",fontSize:"inherit"}),primaryText:"Sin datos",secondaryText:"Selecciona filtros"})})}),sn=({children:t,collapseContent:n,colSpan:s})=>{const[a,l]=o.useState(!1),{isDisabled:r}=o.useContext(U),i=u=>{!r&&u.target instanceof HTMLInputElement&&l(h=>!h)};return e.jsxs(e.Fragment,{children:[e.jsx(T,{sx:{cursor:r?"default":"pointer",":hover":{backgroundColor:({palette:u})=>r?"inherit":u.grey[400]}},onClick:i,children:t}),e.jsxs(T,{children:[e.jsx(C,{padding:a?"normal":"none",colSpan:2}),e.jsx(C,{colSpan:s,padding:a?"normal":"none",children:e.jsx(gt,{in:a,children:n})})]})]})};function an(){const[t,n,{data:s,isFetching:a,total:l,page:r,rowsPerPage:i}]=Qe(),u=o.useCallback((d,c)=>{d&&t(c+1)},[t]),h=o.useCallback(d=>{n(parseInt(d.target.value,10)),t(1)},[t,n]);return e.jsx(e.Fragment,{children:e.jsxs(Ot,{children:[e.jsx(We,{body:a?e.jsx(en,{colSpan:w.length}):e.jsx(nn,{hasContent:!!(s!=null&&s.length),colSpan:w.length,children:a?[]:s==null?void 0:s.map(d=>e.jsx(sn,{colSpan:w.length-2,collapseContent:e.jsx(g,{direction:"row",pr:2,children:e.jsx(ke,{result:d,title:`${d.id}-comments`})}),children:w.map(({resource:c,especialConfig:x,textAlign:m})=>x?e.jsx(C,{sx:{textAlign:m??"center"},children:e.jsx(Zt,{result:d,resource:c,secondaryValue:d.created_at,value:d[c]??"--"})},c+d.id):e.jsx(C,{sx:{textAlign:m??"center",maxWidth:140},children:e.jsx(G,{title:String(d[c]??"--"),children:e.jsx(f,{noWrap:!0,sx:{...c==="key"?{width:60}:{}},children:Ge(String(d[c]??"--"),c==="key")})})},c+d.id))},d.id))}),header:e.jsx(Pt,{data:w})}),e.jsx(v,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(st,{rowsPerPage:i,count:l??1e3,page:r-1,onPageChange:u,onRowsPerPageChange:h,labelRowsPerPage:"Filas por página"})})]})})}const rn=({content:t})=>e.jsx("div",{style:{position:"sticky",bottom:20,left:"90vw",width:40,display:"flex",justifyContent:"flex-end",zIndex:500},children:t}),ln=({input:t,id:n,label:s})=>e.jsxs(A,{sx:{width:200},children:[e.jsx(F,{id:n,children:s}),t]}),on=({label:t,labelId:n,inputProps:s,config:a})=>e.jsx(R,{labelId:n,label:t,sx:{width:200},defaultValue:"all",displayEmpty:!0,inputProps:s,children:a==null?void 0:a.map(({value:l,label:r})=>e.jsx(p,{value:l,children:r},r))}),cn=[{id:"type-uncontrolled",label:"Type",registerField:"type",config:ve},{id:"severity-uncontrolled",label:"Severity",registerField:"severity",config:Ce},{id:"state-uncontrolled",label:"State",registerField:"state",config:be}],dn=({handleChanges:t,text:n,inputProps:s,includeAllOptions:a})=>{const{data:l,isFetching:r}=pe(n==="all"?"":n);if(r)return e.jsx(E,{});const[i]=l??[];return e.jsxs(A,{sx:{width:200},children:[e.jsx(F,{id:"qualityProfile-uncontrolled",children:"Quality Profile"}),e.jsxs(R,{inputProps:s,onChange:t,label:"Quality Profile",labelId:"qualityProfile-uncontrolled",defaultValue:a?"all":i==null?void 0:i.id,children:[a&&e.jsx(p,{value:"all",children:"Todos"}),l==null?void 0:l.map(({id:u,name:h})=>e.jsx(p,{value:u,children:h},u))]})]})},un=({handleClose:t,isOpen:n})=>{const{register:s,handleSubmit:a}=bt(),[l,r]=o.useState(),[i,u]=o.useState(!0),h=o.useCallback(async c=>await Ke().downloadReport({lang_id:c.language_id,qualityProfile_id:c.qualityProfile_id,severity:c.severity,type:c.type,isActiveSonar:c.state},c.showOnlyIsActiveDifferences),[]),d=o.useCallback(c=>{r(c.target.value)},[]);return e.jsx(he,{variant:"persistent",onClose:t,anchor:"right",open:n,children:e.jsx(g,{sx:{minWidth:400},component:"form",onSubmit:a(h),children:e.jsxs(at,{children:[e.jsx(S,{children:e.jsx(rt,{control:e.jsx(ue,{...s("showOnlyIsActiveDifferences"),checked:!i,onChange:c=>u(!c.target.checked)}),label:"Solo estados propuestos"})}),e.jsx(P,{}),e.jsx(S,{children:e.jsx(je,{includeAllOption:i,inputProps:s("language_id"),className:"generic-filter-uncontrolled",handleChange:d})}),e.jsx(S,{children:e.jsx(dn,{includeAllOptions:i,text:l,inputProps:s("qualityProfile_id")})}),i&&e.jsxs(e.Fragment,{children:[e.jsx(P,{}),cn.map(({id:c,label:x,registerField:m,config:M})=>e.jsx(S,{children:e.jsx(ln,{label:x,id:c,input:e.jsx(on,{config:M,label:x,labelId:c,inputProps:s(m)})})},c+x))]}),e.jsx(P,{}),e.jsx(S,{children:e.jsx(mt,{type:"submit",variant:"contained",startIcon:e.jsx(re,{}),sx:{width:"100%"},children:"Descargar"})})]})})})},hn=()=>{const[t,n]=o.useState(!1),s=o.useCallback(()=>{n(!0)},[]),a=o.useCallback(()=>{n(!1)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(p,{onClick:s,children:[e.jsx(xe,{children:e.jsx(re,{})}),e.jsx(fe,{children:"Descarga Personalizada"})]}),e.jsx(un,{handleClose:a,isOpen:t})]})},xn=()=>{const[t]=Ue();return e.jsxs(p,{onClick:t,children:[e.jsx(xe,{children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(fe,{children:"Restaurar"})]})},fn=()=>{const[t,n]=o.useState(null),s=o.useRef(null),a=Je(),l=o.useCallback(()=>{n(null)},[]);o.useEffect(()=>{n(a?s.current:null)},[a]);const r=o.useCallback(({currentTarget:i})=>{n(i)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(Ct,{children:e.jsx(O,{ref:s,onClick:r,sx:{background:({palette:i})=>i.secondary.main,zIndex:500},className:"dragableMenu",children:e.jsx(Fe,{fontSize:"large"})})}),e.jsxs(de,{className:"menuDragable",anchorEl:t,open:!!t,onClose:l,children:[e.jsx(Xe,{}),e.jsx(hn,{}),e.jsx(xn,{})]})]})},gn=()=>{const t=le(),n=Ze(),[s,a]=o.useState(),[l]=vt(s,1e3),r=o.useMemo(()=>t&&n,[t,n]),i=o.useCallback(({target:u})=>{a(u.value)},[]);return o.useEffect(()=>{a(""),te()},[t,n]),o.useEffect(()=>{te(l)},[l]),e.jsx(it,{value:s,disabled:!r,onChange:i,startAdornment:e.jsx(Re,{})})};function qn(){return e.jsxs(e.Fragment,{children:[e.jsxs(g,{gap:3,children:[e.jsxs(f,{children:[e.jsx(Ee,{})," Activa o desactiva los switches dependiendo si deseas habilitar la regla o no"]}),e.jsxs(f,{children:[e.jsx(Oe,{})," Recuerda que los estados que propongas no se aplicarán de inmediato en SonarQube"]})]}),e.jsx(g,{direction:"column",gap:4,marginTop:4,children:e.jsxs(v,{display:"flex",gap:4,children:[e.jsx(_t,{}),e.jsx(St,{}),e.jsx(gn,{})]})}),e.jsx(an,{}),e.jsx(rn,{content:e.jsx(fn,{})})]})}export{qn as default};
