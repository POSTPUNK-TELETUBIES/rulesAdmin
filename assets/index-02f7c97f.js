var Et=Object.defineProperty;var Mt=(s,t,n)=>t in s?Et(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n;var w=(s,t,n)=>(Mt(s,typeof t!="symbol"?t+"":t,n),n);import{N as Xe,j as e,a7 as Ot,a8 as Ze,a9 as Dt,aa as Se,ab as Nt,ac as qt,ad as Bt,ae as Qt,af as zt,ag as Ut,ah as $t,ai as Vt,aj as Ht,ak as et,al as Wt,am as Yt,an as Kt,ao as Gt,ap as Jt}from"./@mui/icons-material-ab3a2dd4.js";import{a as Xt,r as l,e as Zt,d as Pe,g as tt,b as es}from"./vendor-207237f2.js";import{u as ts,S as ss}from"./notistack-db4c90f8.js";import{u as st,C as ns,S as as,a as Te,F as P,I as T,O as W,b as rs,c as y,B as b,L as nt,G as ve,P as is,T as os,d as ls,e as cs,f as us,g as ds,M as k,h as pe,i as xe,D as hs,j as gs,k as ms,l as Y,m as _,n as Ue,o as ps,p as xs,q as fs,r as js,A as ys,s as bs,t as Re,v as Ae,w as at,x as fe,y as Cs,z as vs,E as rt,H as $e,J as oe,K as ws,N as te,Q as _s,R as Ss}from"./@mui/material-cee8dd7b.js";import{w as ks,u as it,s as z,x as ot,y as Is,b as f,z as D,P as Ps,C as V,D as je,E as Le,H as Ts,J as Rs,M as As,N as Ls,O as Fs,Q as Es,R as Ms,S as Os,U as Ds}from"./@mui/lab-869fd29d.js";import{u as lt,L as Ns,N as ct,R as qs,a as ae,B as Bs}from"./react-router-dom-99b80545.js";import{u as Qs,a as zs,b as ut,c as Fe,A as Us}from"./react-auth-kit-dfa0a854.js";import{u as Ee}from"./react-hook-form-53b9354b.js";import{c as Me}from"./@supabase/supabase-js-0380770c.js";import{u as K,Q as $s,a as Vs}from"./@tanstack/react-query-b125ade5.js";import{b as ge}from"./react-lazy-load-image-component-3f9d37e3.js";import{X as Hs}from"./dexie-911c5dc6.js";import{d as Ws}from"./dexie-react-hooks-efe53238.js";import{a as Ys}from"./axios-4a70c6fc.js";import{p as Ks}from"./papaparse-6ea79c53.js";import{c as L}from"./@react-rxjs/utils-31d3d490.js";import{b as F}from"./@react-rxjs/core-8fefe617.js";import{u as Gs,T as Js}from"./@reactour/tour-6e99e852.js";import{d as Xs,a as G}from"./dayjs-f30b717c.js";import{c as Zs,o as en}from"./use-debounce-ff8cde72.js";import{D as tn}from"./react-draggable-7aabed6d.js";import{h as sn}from"./hotkeys-js-46483ca1.js";import"./@emotion/react-23f5b1b9.js";import"./@emotion/styled-94d978bf.js";import"./@supabase/postgrest-js-d220d860.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var ke={},Ve=Xt;ke.createRoot=Ve.createRoot,ke.hydrateRoot=Ve.hydrateRoot;var ne=(s=>(s.DARK="dark",s.LIGTH="light",s))(ne||{});const dt={fontFamily:["Foco"].join(",")},nn=Xe({palette:{mode:"dark"},typography:{...dt}}),an=Xe({palette:{mode:"light",primary:{main:"#0099CC"},secondary:{main:"#EE2C70"}},typography:{...dt}}),ht=l.createContext({toggleColorMode(){}}),rn=({children:s})=>{const t=st("(prefers-color-scheme: dark)"),[n,a]=l.useState(localStorage.getItem("mode")||(t?"light":"dark")),r=l.useMemo(()=>({toggleColorMode(){a(i=>i==="dark"?"light":"dark")}}),[]);return l.useEffect(()=>{localStorage.setItem("mode",n)},[n]),e.jsx(ht.Provider,{value:r,children:e.jsxs(ks,{theme:n==="dark"?nn:an,children:[e.jsx(ns,{}),s]})})},on=({handleClose:s,handleOpen:t,isOpen:n,content:a})=>{const r=it(),i=st(r.breakpoints.up("md"));return e.jsx(as,{PaperProps:{sx:{justifyContent:"center"}},onOpen:t,onClose:s,open:n,anchor:i?"right":"bottom",children:e.jsx(Te,{sx:ln,children:a})})},ln={maxWidth:500,width:{md:"50vw"},minHeight:"50vh",display:"grid",placeContent:"center"},Ie=({inputProps:s,disabled:t,id:n="password",label:a="Contraseña"})=>{const[r,i]=l.useState(!1),o=l.useCallback(()=>{i(d=>!d)},[]);return e.jsxs(P,{disabled:t,children:[e.jsx(T,{htmlFor:n,children:a}),e.jsx(W,{id:n,type:r?"text":"password",inputProps:s,endAdornment:e.jsx(rs,{position:"end",children:e.jsx(z,{"aria-label":"toggle password visibility",onMouseDown:d=>d.preventDefault(),edge:"end",onClick:o,children:r?e.jsx(Ot,{}):e.jsx(Ze,{})})}),label:a})]})};var le=(s=>(s.FIRST_VISIT="firstVisit",s.TIMES_VISIT="timesVisit",s))(le||{});class cn extends Error{constructor(t){super(`${t} is required, please do check .envexample to provide one similar into .env file`)}}const gt=s=>{const t={VITE_SUPABASE_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndyaXBhbnFobXdnbnJua25iZ2tiIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODcyMTU5NDksImV4cCI6MjAwMjc5MTk0OX0.FUBAfuwsSF69KLApkOttj3RLHDaQ4d6pBJujZnrLOzk",VITE_WOOPRA_DOMAIN:"pacifico.dev.com",VITE_IS_HASH:"",VITE_SUPABASE_URL:"https://wripanqhmwgnrnknbgkb.supabase.co",VITE_TYPE_CLIENT:"supabase",BASE_URL:"/rulesAdmin",MODE:"production",DEV:!1,PROD:!0,SSR:!1}[s];if(!t)throw new cn(s);return t},un=(s,t=!0,n=document.body)=>{const a=n.querySelector(s);a&&(a.style.overflow=t?"hidden":"auto")},dn=s=>s<=3,hn=()=>{const s=localStorage.getItem(le.TIMES_VISIT);if(dn(Number(s)))return localStorage.setItem(le.FIRST_VISIT,new Date().toDateString()),localStorage.setItem(le.TIMES_VISIT,((Number(s)||0)+1).toString()),!0},He=s=>s!=null,gn={css:1,java:1,web:1,Web:1,javascript:1,typescript:1},mn=(s,t=gn)=>{const[n]=s.match(/^.+:/);return t[n.substring(0,n.length-1)]?s.replace(n,""):s},pn=(s,t,n)=>t?mn(s,n):s,We=(s,t,n)=>s?t:n,mt=(s,t,n)=>s==null?void 0:s.reduce((a,r)=>(a[String(r[t])]=n?r[n]:r,a),{}),xn=()=>{const s=new Date;return s.setUTCHours(0),s.setUTCMinutes(0),s},fn=s=>{const t=[],n=new Date;for(let a=0;a<s;a++){n.setMinutes(n.getMinutes()-a);const r={id:a+1,author:"asda",timestamp:"asdsa",content:"asdasdsad"};t.push(r)}return t},ye=gt("VITE_SUPABASE_TOKEN"),be=gt("VITE_SUPABASE_URL"),jn="supabase",N=class{constructor(t){w(this,"isLogged");w(this,"user");this.client=t}async singUp({email:t,firstName:n,lastName:a,password:r,username:i}){const{data:o,error:d}=await this.client.signUp({email:t,password:r,options:{data:{first_name:n,last_name:a,username:i}}});if(d)throw d;return o}static getInstance(t){return N.instance??(N.instance=new N(t??Me(be,ye).auth)),N.instance}async login(t,n){if(!t||!n)throw new Error("Not valid email or password");const{data:a,error:r}=await this.client.signInWithPassword({email:t,password:n});if(r)throw r;return this.isLogged=!0,this.user=a.user,a}async verifyAuth(t){const{data:n,error:a}=await this.client.getUser(t);if(a)throw a;return n}async logOut(t){const{error:n}=await this.client.signOut();if(n)throw n;return this.user=null,t}async getPermissions(){const{data:t,error:n}=await this.client.mfa.getAuthenticatorAssuranceLevel();if(n)throw n;return t}};let ce=N;w(ce,"instance");const we=void 0,yn=we==null?void 0:we.serverInit();window.mockServer=yn;const pt=Me(be,ye),Oe=ce.getInstance(pt.auth);function bn(){const[s,t]=l.useState(null),n=zs();return{...K(["login"],async()=>{const r=await Oe.login(s==null?void 0:s.email,s==null?void 0:s.password);return n({expiresIn:r.session.expires_in,token:r.session.access_token,tokenType:r.session.token_type,authState:r.user}),t(null),r},{enabled:!!s,staleTime:0,cacheTime:0}),setLoginInfo:t}}function Cn(){const[s,t]=l.useState();return{...K(["register",s],()=>Oe.singUp(s),{enabled:!!s}),setRegisterInfo:t}}function vn(){const s=Qs();return()=>{Oe.logOut(),s()}}function wn({singUpClick:s,isSingUpAvailable:t}){const{handleSubmit:n,register:a,resetField:r}=Ee(),{data:i,setLoginInfo:o,isFetching:d,error:h}=bn(),c=lt(),{enqueueSnackbar:u}=ts(),x=l.useCallback(async({email:m,password:g})=>{o({email:m,password:g}),r("password")},[r,o]);return l.useEffect(()=>{h&&u({message:"Credenciales invalidas",variant:"error"})},[u,h]),l.useEffect(()=>{!h&&i&&c("/admin")},[h,i,c]),e.jsxs(y,{component:"form",onSubmit:n(x),spacing:2,children:[e.jsx(b,{display:"flex",justifyContent:"center",children:e.jsx(ot,{sx:{width:80,height:80}})}),e.jsxs(P,{disabled:d,children:[e.jsx(T,{htmlFor:"email",children:"Correo Electronico"}),e.jsx(W,{id:"email",label:"Correo Electronico",inputProps:a("email")})]}),e.jsx(Ie,{disabled:d,inputProps:a("password")}),e.jsx(Is,{type:"submit",variant:"contained",disabled:d,loading:d,children:"Iniciar Sesión"}),t&&e.jsxs(f,{align:"center",children:["¿Aún no te registras? ",e.jsx(nt,{onClick:s,children:"Registrate"})," "]})]})}const _n=({handleLoginClick:s})=>{const{register:t,handleSubmit:n}=Ee(),{setRegisterInfo:a,isFetching:r}=Cn(),i=l.useCallback(o=>{a(o)},[]);return e.jsxs(y,{component:"form",onSubmit:n(i),spacing:2,children:[e.jsxs(P,{disabled:r,children:[e.jsx(T,{htmlFor:"email",children:"Email"}),e.jsx(W,{id:"email",label:"Email",inputProps:t("email")})]}),e.jsx(Ie,{inputProps:t("password")}),e.jsx(Ie,{id:"confirmPassword",label:"Confirm Password",inputProps:t("confirmPassword")}),e.jsxs(P,{disabled:r,children:[e.jsx(T,{htmlFor:"username",children:"Username"}),e.jsx(W,{id:"username",label:"Username",inputProps:t("username")})]}),e.jsxs(P,{disabled:r,children:[e.jsx(T,{htmlFor:"lastName",children:"Apellido"}),e.jsx(W,{id:"lastName",label:"Apellido",inputProps:t("lastName")})]}),e.jsxs(P,{disabled:r,children:[e.jsx(T,{htmlFor:"firstName",children:"Nombre"}),e.jsx(W,{id:"firstName",label:"Nombre",inputProps:t("firstName")})]}),e.jsx(D,{type:"submit",variant:"contained",children:"Sing up"}),e.jsxs(f,{align:"center",children:["¿Ya tienes cuenta? ",e.jsx(nt,{onClick:s,children:"Log in"})]})]})},Sn="_container_862mo_1",kn="_imgContainer_862mo_5",In="_img_862mo_5",Pn="_textContainer_862mo_18",Tn="_title_862mo_36",Rn="_subtitle_862mo_40",$={container:Sn,imgContainer:kn,"lazy-load-image-background":"_lazy-load-image-background_862mo_10",img:In,textContainer:Pn,title:Tn,subtitle:Rn};const An=({isSingUpAvailable:s})=>{const[t,n]=l.useState(!1),[a,r]=l.useState(!0),i=l.useCallback((c=!0)=>()=>{n(!0),r(c)},[]),o=l.useCallback(()=>{n(!1)},[]),d=l.useCallback(()=>{r(!1)},[]),h=l.useCallback(()=>{r(!0)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{container:!0,columns:{xs:6,md:12},className:$.container,children:[e.jsx(ve,{item:!0,xs:6,className:$.imgContainer,children:e.jsx(ge.LazyLoadImage,{src:"admin3.webp",className:$.img,alt:"chica sujetando en sus manos una laptop de colo negra",effect:"blur",width:"100%"})}),e.jsx(ve,{item:!0,xs:6,children:e.jsxs(b,{p:{xs:3,sm:8,lg:14},className:$.textContainer,children:[e.jsx("h2",{className:$.title,children:"Administración de reglas de SonarQube"}),e.jsx("h3",{className:$.subtitle,children:"Personalize y configure sin esfuerzo para optimizar la calidad del codigo."}),e.jsxs(y,{gap:2,direction:{sm:"column",md:"row"},marginTop:{xs:2,sm:4},children:[s&&e.jsx(D,{variant:"contained",onClick:i(!1),children:"Registrate"}),e.jsx(D,{variant:"outlined",onClick:i(),sx:{px:6},style:{alignSelf:"center",width:"max-content"},children:"Iniciar sesión"})]})]})})]}),e.jsx(on,{content:a?e.jsx(wn,{singUpClick:d}):e.jsx(_n,{handleLoginClick:h}),handleClose:o,handleOpen:i,isOpen:t})]})},Ln="_container_w2oxn_1",Fn="_img_w2oxn_6",En="_box_w2oxn_12",Mn="_title_w2oxn_24",re={container:Ln,img:Fn,box:En,title:Mn},On=()=>e.jsxs("div",{className:re.container,children:[e.jsx(ge.LazyLoadImage,{src:"error404.webp",className:re.img,alt:"Fondo degradado",effect:"blur",width:"100%",height:"100%"}),e.jsxs("div",{className:re.box,children:[e.jsx("h1",{className:re.title,children:"¡Ups! Esta página no existe"}),e.jsx(Ns,{to:"/",children:e.jsx(D,{variant:"contained",size:"large",children:"Volver al inicio"})})]})]}),q=class extends Hs{constructor(){super("syncro");w(this,"rulesStatus");this.version(5).stores({rulesStatus:"id, updated_at, newStatus, language, qualityProfileId, description, user_email"})}static getInstance(){return q.instance??(q.instance=new q),q.instance}async getLocalRules(n){return await this.rulesStatus.where("id").anyOf(n).toArray()}async countAllRules(){return await this.rulesStatus.count()}async saveDescription(n,a){const r=await this.rulesStatus.get(n.id);return await this.rulesStatus.put({id:Number(n.id),languageId:n.lang_id,newStatus:n.isActive,qualityProfileId:Number(n.qualityProfile_id),...r,updated_at:new Date,...a?{description:a}:{},user_email:n.user_email})}async getRulesToUpdate(){return await this.rulesStatus.toArray()}};let ue=q;w(ue,"instance");const S=ue.getInstance(),Dn={width:"80vh",maxWidth:600,minWidth:400,height:"80vh",minHeight:400,borderRadius:50},Nn=l.memo(function({popoverBody:s,icon:t,sxProps:n,textButton:a,buttonProps:r}){const[i,o]=l.useState(null),d=l.useCallback(c=>{c.stopPropagation(),o(c.currentTarget)},[]),h=l.useCallback(c=>{c.stopPropagation(),o(null)},[]);return e.jsxs(e.Fragment,{children:[a?e.jsx(D,{startIcon:t,onClick:d,...r,children:a}):e.jsx(z,{onClick:d,sx:{margin:"auto"},children:t}),e.jsxs(is,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:n??Dn,open:!!i,onClose:h,anchorEl:i,children:[e.jsx(z,{onClick:h,sx:{position:"absolute",top:0,right:0},children:e.jsx(Dt,{sx:{fontSize:"medium"}})}),e.jsx(b,{margin:1,children:s})]})]})}),B=class{constructor(t){this.client=t}getConflicts(t){throw new Error("Method not implemented.")}getByRuleName(t,n,a){throw new Error("Method not implemented.")}downloadReport(t){throw new Error("Method not implemented.")}postNewStatus(t){throw new Error("Method not implemented.")}async getTotalCountByTable(t){return 100}static getInstance(){return B.instance??(B.instance=new B(Ys.create({baseURL:be,headers:{apiKey:ye}}))),B.instance}async getPaginatedRulesByFilter(t,n){const{data:a}=await this.client.get("/rules",{params:{...t,...n}});return{data:a,count:100}}async getQualityProfilesByLanguage(t){const{data:n}=await this.client.get("/qualityprofiles",{params:{language_id:t}});return n}async getAllLanguages(){const{data:t}=await this.client.get("/languages");return t}};let de=B;w(de,"instance");const qn=de.getInstance,Q=class{static getInstance(){return Q.instance??(Q.instance=new Q),Q.instance}parseReport(t){const n=t.map(({rules:a,qualityprofiles:r,...i})=>({...a,...r,...i,ruleKey:a.key,qualityProfileName:r.name,ruleName:a.name}));return Ks.unparse(n,{columns:["qualityProfileName","ruleKey","ruleName","severity","type","updated_at","created_at","description","isActiveSonar","isActive","user_email"]})}};let he=Q;w(he,"instance");const Bn=he.getInstance(),A=class{constructor(t,n=Bn){this.client=t,this.reportGenerator=n}static getInstance(t){return A.instance??(A.instance=new A(t??Me(be,ye))),A.instance}async getConflicts(t){const n=xn().toISOString(),a=this.client.from("status").select(`
        *,
        qualityprofiles(
        *
        ),
        rules!inner(
          *
      )
      `).in("id",t.map(({id:d})=>d)).gt("updated_at",n).throwOnError(),{data:r}=await a,i=mt(r,"id");return t.filter(({id:d,newStatus:h})=>{var c,u;return He((c=i[d])==null?void 0:c.isActive)&&((u=i[d])==null?void 0:u.isActive)!==h}).map(d=>{const{rules:h,...c}=i[d.id];return{...h,...c,...d}})}async getCSVReportUpdatables(t){const{data:n}=await this.client.rpc("get_changed_q",{quality_id:Number(t)}).select("*").csv().throwOnError();return n}async getCSVCompleteFiltered(t){const{data:n}=await this.prepareFilteredQuery(t).throwOnError();return this.reportGenerator.parseReport(n)}async downloadReport(t,n=!0){const a=n?await this.getCSVReportUpdatables(Number(t.qualityProfile_id)):await this.getCSVCompleteFiltered(t),r=document.createElement("a");r.download="report";const i=URL.createObjectURL(new Blob([a],{type:"text/csv"}));r.href=i,r.click(),URL.revokeObjectURL(i),r.remove()}changeIsActive(t,n=!0){if(!t.length)return;const[{user_email:a}]=t;return this.client.from("status").update({isActive:n,updated_at:new Date,user_email:a}).in("id",t.map(({id:r})=>r)).throwOnError()}async bulkUpdateDescription(t){if(!t.length)return;const{data:n}=await this.client.auth.getUser();return await this.client.from("status").upsert(t.map(({id:a,description:r,qualityProfileId:i})=>{var o;return{id:a,description:r,qualityProfile_id:i,user_email:(o=n.user)==null?void 0:o.email}})).select().throwOnError()}async postNewStatus(t){const n=t.filter(({newStatus:i})=>!i),a=t.filter(({newStatus:i})=>i),r=t.filter(({description:i})=>!!i);await Promise.all([this.changeIsActive(n,!1),this.changeIsActive(a,!0),this.bulkUpdateDescription(r)])}async getTotalCountByTable(t){const{count:n}=await this.client.from(t).select("*",{count:"exact",head:!0}).throwOnError();return n??0}getQualityProfilesByLanguageQuery(t){return this.client.from("qualityprofiles").select().eq("language_id",t).throwOnError()}async getQualityProfilesByLanguage(t){const{data:n}=await this.getQualityProfilesByLanguageQuery(t);return n}buildQuery(t,n){for(const a in n){if(!Object.prototype.hasOwnProperty.call(n,a))continue;const r=n[a];r!=="all"&&He(r)&&(t=t.eq(A.queryBuilderColumns[a],r))}return t}prepareFilteredQuery(t){delete t.lang_id;const n=this.client.from("status").select(`
        *,
        qualityprofiles(
          *
        ),
        rules!inner(
          *
        )
      `,{count:"exact"});return this.buildQuery(n,t)}getPaginatedRulesByFilterQuery(t,n){return this.prepareFilteredQuery(t).range(...this.getRange(n)).order("id",{ascending:!0}).throwOnError()}async getPaginatedRulesByFilter(t,n){const{data:a,count:r}=await this.getPaginatedRulesByFilterQuery(t,n);return{data:a,count:r}}getAllLanguagesQuery(){return this.client.from("languages").select().throwOnError()}async getAllLanguages(){const{data:t}=await this.getAllLanguagesQuery();return t.filter(({name:n})=>A.whiteList[n])}getRange({page:t,limit:n=10}){return[(t-1)*n,t*n-1]}async getByRuleName(t,n,a){const{data:r,count:i}=await this.prepareFilteredQuery(n).ilike("rules.name",`%${t}%`).range(...this.getRange(a)).order("id",{ascending:!0}).throwOnError();return{data:r,count:i}}subscribeChanges(t){if(!{}.VITE_IS_INTERCEPTOR_ON)return this.client.channel("changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"status"},t).subscribe()}};let H=A;w(H,"instance"),w(H,"whiteList",{ts:!0,js:!0,css:!0,java:!0,web:!0}),w(H,"queryBuilderColumns",{severity:"rules.severity",type:"rules.type",isActiveSonar:"isActiveSonar",qualityProfile_id:"qualityProfile_id"});const De=H.getInstance,Qn={axios:qn,supabase:()=>De(pt)},U=Qn[jn](),[zn,Un]=L(),[Ne]=F(zn,""),[$n,Vn]=L(),[Hn]=F($n,"all"),[Wn,Yn]=L(),[Kn]=F(Wn,null),[Gn,Jn]=L(),[Xn]=F(Gn,"all"),[Zn,Ye]=L(),[xt]=F(Zn,""),[ea,ta]=L();F(ea,0);const[sa,me]=L(),[na]=F(sa,1),[aa,ra]=L(),[ia]=F(aa,!1),[oa,Ke]=L(),[la]=F(oa,null),qe=new $s({defaultOptions:{queries:{staleTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1,_optimisticResults:"optimistic"}}}),ca=()=>{const s=Xn(),t=Ne(),n=Kn(),a=xt(),r=Hn(),i=na(),o=la();return{severity:s,lang_id:t,isActiveSonar:n,qualityProfile_id:a,type:r,page:i,textMatchFilter:o}},ua=()=>{const{isActiveSonar:s,lang_id:t,page:n,qualityProfile_id:a,severity:r,textMatchFilter:i,type:o}=ca(),[d,h]=l.useState(10),c=l.useRef(0),[u,x]=l.useState([]),[m,g]=l.useState(null),p=!!(t&&a),{data:I,isFetching:J,isLoading:X,isRefetching:Z,isFetched:Ce}=K({queryKey:["rules",t,a,o,s,r,n,d,i],async queryFn(){const j={severity:r,lang_id:t,isActiveSonar:s,qualityProfile_id:a,type:o},C={page:n,limit:d},{data:M,count:O}=i?await U.getByRuleName(i,j,C):await U.getPaginatedRulesByFilter(j,C);return c.current=O,ta(O),M},enabled:p,keepPreviousData:!0});l.useEffect(()=>{me(1)},[o,r,s,a,i]);const E=l.useCallback(async()=>{if(!p)return;const j=I==null?void 0:I.map(({rules:v,...R})=>{var ee;return{...v,...R,...Number((ee=m==null?void 0:m.new)==null?void 0:ee.id)===Number(R.id)?m==null?void 0:m.new:{},isActiveOriginal:R.isActive}}),M=(j?await S.getLocalRules(j.map(({id:v})=>Number(v))):[]).reduce((v,R)=>(v[R.id]=R,v),{}),O=j==null?void 0:j.map(v=>{var R,ee;return{...v,isActive:((R=M[v.id])==null?void 0:R.newStatus)??v.isActive,description:((ee=M[v.id])==null?void 0:ee.description)??v.description}});x(O)},[I,p,m]);return l.useEffect(()=>{E()},[I,n,E]),l.useEffect(()=>{const j=De().subscribeChanges(C=>g({...C}));return()=>{j==null||j.unsubscribe()}},[]),[me,h,{data:u,isFetching:J,isLoading:X,total:c.current,page:n,isFetched:Ce,rowsPerPage:d,isRefetching:Z}]},da=()=>{const[s,t]=l.useState(!1);return[l.useCallback(async a=>{t(!0);const r=await S.rulesStatus.toArray(),i=a?r.filter(({id:o})=>a[Number(o)]):r;await U.postNewStatus(i),await S.rulesStatus.clear(),await qe.invalidateQueries({queryKey:["rules"]}),me(1),t(!1)},[]),s]},ha=()=>{const[s,t]=l.useState(!1);return[l.useCallback(async()=>{t(!0),await S.rulesStatus.clear(),await qe.invalidateQueries({queryKey:["rules"]}),me(1),t(!1)},[]),s]},ft=l.memo(function({body:t,header:n,footer:a,stickyHeader:r=!0}){return e.jsxs(Ps,{sx:{my:4,background:"transparent"},children:[e.jsx(os,{sx:{maxHeight:"80vh"},children:e.jsxs(ls,{stickyHeader:r,children:[e.jsx(cs,{children:n}),e.jsx(us,{sx:{backgroundColor:({palette:i})=>i.mode===ne.DARK?i.grey[800]:i.grey[300]},children:t}),a&&t&&e.jsx(ds,{children:a})]})}),!t&&e.jsx("div",{children:"asdsadsadsda"})]})}),Ge=[{resource:"key",label:"Codigo"},{resource:"name",label:"Regla"},{resource:"newStatus",label:"Estado local"}],jt=()=>{const[s]=da(),[t,n]=l.useState(!1),[a,r]=l.useState([]),i=l.useRef({}),[o,d]=l.useState(!1),h=l.useCallback(()=>{n(!1)},[]),c=l.useCallback(()=>{const{current:g}=i,p=Object.values(g).length?g:void 0;s(p),h()},[s,h]),u=l.useCallback(async()=>{const g=await S.getRulesToUpdate(),p=await U.getConflicts(g);if(r(p),p!=null&&p.length)return n(!0);c()},[c]),x=l.useCallback((g,p)=>{if(p.target.checked)return i.current[g]=!0;delete i.current[g]},[]),m=l.useCallback(g=>{d(g.target.checked)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{onClick:u,children:[e.jsx(pe,{children:e.jsx(Se,{fontSize:"small"})}),e.jsx(xe,{children:"Sincronizar"})]}),e.jsxs(hs,{onClose:h,open:t,children:[e.jsx(gs,{children:"Hay conflictos"}),e.jsxs(ms,{children:[e.jsx(ft,{header:e.jsxs(Y,{children:[e.jsx(_,{children:e.jsx(Ue,{checked:o,onChange:m})}),Ge.map(({label:g})=>e.jsx(_,{children:g},g))]}),body:e.jsx(e.Fragment,{children:a==null?void 0:a.map(g=>e.jsxs(Y,{children:[e.jsx(_,{children:e.jsx(Ue,{disabled:o,onChange:p=>x(g.id,p)})}),Ge.map(p=>e.jsx(_,{id:`${g.id}-${p.label}`,children:typeof g[p.resource]=="boolean"?g[p.resource]?"Activo":"Inactivo":g[p.resource]}))]},g.id))})}),e.jsx(ps,{children:e.jsx(D,{onClick:c,startIcon:e.jsx(Se,{}),children:"Sincronizar"})})]})]})]})},ga=()=>U.getAllLanguages(),ma=()=>{var a;const s=Ws.useLiveQuery(()=>S.rulesStatus.toArray()),{data:t}=K({queryKey:["languages"],queryFn:ga}),n=l.useMemo(()=>mt(t,"id","name"),[t]);return e.jsx(Nn,{icon:We(!(s!=null&&s.length),e.jsx(qt,{}),e.jsx(Nt,{})),textButton:e.jsx(f,{children:We(!!(s!=null&&s.length),"Tienes cambios sin sincronizar","No hay cambios sin sincronizar")}),buttonProps:{variant:"contained"},popoverBody:e.jsx(xs,{children:t&&e.jsxs(fs,{children:[(a=s==null?void 0:s.filter(({languageId:r},i,o)=>o.findIndex(({languageId:d})=>d===r)===i))==null?void 0:a.map(({languageId:r},i)=>e.jsx(y,{direction:"row",children:e.jsx(V,{label:n[r]})},i)),e.jsx(js,{children:e.jsx(jt,{})})]})})})},pa="_header_181un_1",xa="_bg_181un_6",fa="_title_181un_10",ja="_logo_181un_15",ie={header:pa,bg:xa,title:fa,logo:ja},ya=()=>{var m,g;const s=lt(),{palette:t}=it(),n=l.useContext(ht),[a,r]=l.useState(null),i=ut(),o=Fe(),d=vn(),h=l.useCallback(()=>n.toggleColorMode(),[n]),c=l.useCallback(({currentTarget:p})=>{r(p)},[]),u=l.useCallback(()=>{r(null)},[]),x=l.useCallback(()=>{d(),u(),s("home")},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(ys,{position:"sticky",className:ie.header,children:[e.jsx(ge.LazyLoadImage,{src:"BannerDegrade.webp",style:{background:"green",top:"0"},className:ie.bg,effect:"blur"}),e.jsx(Te,{sx:{py:2},children:e.jsxs(bs,{disableGutters:!0,sx:{justifyContent:"space-between"},children:[e.jsxs(b,{gap:{xs:0,sm:1},className:ie.title,children:[e.jsxs(b,{display:"flex",gap:1,alignItems:"center",children:[e.jsx(ge.LazyLoadImage,{src:"logo.webp",effect:"blur",alt:"logo de pacifico",className:ie.logo,style:{display:"flex"}}),e.jsx(f,{variant:"h6",fontWeight:900,fontSize:{xs:"1.4rem",sm:"1.6rem"},children:"Sonardash"})]}),e.jsx(f,{variant:"body1",children:"/ Gestión de Reglas"})]}),i()&&e.jsx(ma,{}),e.jsxs(y,{direction:"row",justifyContent:"center",alignItems:"center",children:[(t==null?void 0:t.mode)===ne.DARK?e.jsx(Bt,{}):e.jsx(Qt,{}),e.jsx(Re,{color:"warning",onChange:h}),i()&&e.jsx(D,{sx:{borderRadius:"50%"},onClick:c,children:e.jsx(ot,{sx:{width:40,height:40},variant:"circular",children:(g=(m=o())==null?void 0:m.user)==null?void 0:g.email})})]})]})})]}),e.jsx(Ae,{open:!!a,anchorEl:a,onClose:u,children:e.jsx(at,{children:e.jsxs(k,{onClick:x,children:[e.jsx(pe,{children:e.jsx(zt,{})}),e.jsx(xe,{children:"Log out"})]})})})]})},ba=()=>{const{data:s,isLoading:t}=K({queryKey:["languages"],queryFn:()=>U.getAllLanguages()});return{data:s,isLoading:t}},yt=s=>{const{data:t,isFetching:n}=K({queryKey:["qualityprofile",s],queryFn:()=>U.getQualityProfilesByLanguage(s),enabled:!!s});return{data:t,isFetching:n}},bt=({className:s,handleChange:t,inputProps:n,includeAllOption:a,displayEmpty:r})=>{const{data:i,isLoading:o}=ba();return e.jsx(P,{sx:{width:200},className:s,children:o?e.jsx(je,{}):e.jsxs(e.Fragment,{children:[e.jsx(T,{id:"language",children:"Lenguaje"}),e.jsxs(fe,{inputProps:n,labelId:"language",label:"Lenguaje",onChange:t,sx:{width:200},defaultValue:a?"all":"",displayEmpty:r,children:[a&&e.jsx(k,{value:"all",children:"Todos"}),i==null?void 0:i.map(({id:d,name:h})=>e.jsx(k,{value:d,children:h},d))]})]})})},Ca=()=>{const{setIsOpen:s,isOpen:t}=Gs(),n=l.useCallback(a=>{Un(a.target.value)},[]);return l.useEffect(()=>{const a=hn();s(a)},[s]),l.useEffect(()=>{un("body",t==null?void 0:t.valueOf())},[t]),e.jsx(bt,{className:"language",handleChange:n,displayEmpty:!0})},va=()=>{const s=Ne(),t=l.useRef(null),{data:n,isFetching:a}=yt(s);l.useEffect(()=>{var i;Ye(((i=t.current)==null?void 0:i.value)??"")},[s]);const r=l.useCallback(i=>{Ye(i.target.value)},[]);return a?e.jsx(je,{}):e.jsxs(P,{className:"mainFilters",sx:{width:200},children:[e.jsx(T,{id:"qualityprofile",children:"Quality Profile"}),e.jsx(fe,{ref:t,onChange:r,label:"Quality Profile",labelId:"qualityprofile",defaultValue:"",displayEmpty:!0,children:n==null?void 0:n.map(({id:i,name:o})=>e.jsx(k,{value:i,children:o},i))})]})},wa=({value:s,label:t,reactiveCb:n})=>{const a=l.useCallback(()=>{n(s)},[n,s]);return e.jsx(k,{onClick:a,children:t})},Be=({filterConfig:s,reactiveCallback:t,isClosingRecursive:n})=>{const[a,r]=l.useState(null),[i,o]=l.useState(!0),d=l.useCallback(u=>{t(u),o(u==="all"),n&&r(null)},[n,t]),h=l.useCallback(()=>{r(null)},[]),c=l.useCallback(u=>{u.preventDefault(),r(u.currentTarget)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:c,sx:{padding:"1px !important"},children:e.jsx(Cs,{variant:"dot",invisible:i,color:"secondary",children:e.jsx(Ut,{sx:{color:"#e4a010"}})})}),e.jsx(Ae,{anchorEl:a,onClose:h,open:!!a,children:s.map(({value:u,label:x})=>e.jsx(wa,{label:x,value:u,reactiveCb:d}))})]})};var Ct=(s=>(s.Blocker="BLOCKER",s.Critical="CRITICAL",s.Info="INFO",s.Major="MAJOR",s.Minor="MINOR",s))(Ct||{}),vt=(s=>(s.Bug="BUG",s.CodeSmell="CODE_SMELL",s.SecurityHotspot="SECURITY_HOTSPOT",s.Vulnerability="VULNERABILITY",s))(vt||{});const wt=[{value:"all",label:"Todos"},...Object.values(vt).map(s=>({value:s,label:s}))],_t=[{value:"all",label:"Todos"},...Object.values(Ct).map(s=>({value:s,label:s}))],St=[{value:"all",label:"Todos"},{value:"active",label:"Activo"},{value:"deactive",label:"Inactivo"}],_a=Object.freeze({all:null,active:!0,deactive:!1}),Sa=()=>{const s=l.useCallback(t=>{Yn(_a[t])},[]);return e.jsx(Be,{filterConfig:St,isClosingRecursive:!0,reactiveCallback:s})},ka=()=>{const s=l.useCallback(t=>{Jn(t)},[]);return e.jsx(Be,{filterConfig:_t,isClosingRecursive:!0,reactiveCallback:s})},Ia=()=>{const s=l.useCallback(t=>Vn(t),[]);return e.jsx(Be,{filterConfig:wt,isClosingRecursive:!0,reactiveCallback:s})},se=[{label:"",especialConfig:!0,resource:"htmlDesc"},{label:"Código",resource:"key",textAlign:"left"},{label:"Regla",resource:"name",textAlign:"left"},{label:"Tipo",resource:"type",filter:e.jsx(Ia,{}),textAlign:"left"},{label:"Severidad",resource:"severity",textAlign:"left",filter:e.jsx(ka,{})},{label:"E. Actual",resource:"isActiveSonar",especialConfig:!0,className:"actualState",textAlign:"left",filter:e.jsx(Sa,{}),sxProps:{minWidth:100}},{label:"E. Propuesto",resource:"isActive",especialConfig:!0,className:"proposedState",sxProps:{minWidth:100}},{label:"Propuesta",resource:"updated_at",especialConfig:!0,icon:e.jsx($t,{sx:{color:s=>s.palette.common.white}})},{label:"Autor",resource:"user_email",sxProps:{width:150}}],Pa=l.memo(({data:s})=>e.jsx(e.Fragment,{children:e.jsx(Y,{children:s.map(({label:t,icon:n,filter:a,className:r,sxProps:i})=>e.jsx(_,{variant:"head",className:r,sx:{background:o=>`${o.palette.grey[900]} !important`,...i},children:e.jsxs(y,{direction:"row",gap:.5,alignItems:"center",justifyContent:"space-between",children:[e.jsx(f,{sx:{color:o=>o.palette.common.white},fontWeight:700,children:t}),n,a]})},t))})}));function Ta({initialStatus:s,result:t,id:n}){const[a,r]=l.useState(!1),[i,o]=l.useState(s),d=Fe();l.useEffect(()=>{o(s)},[s]),l.useEffect(()=>{S.rulesStatus.get(Number(n)).then(u=>r(!!u))},[n]);const h=t.isActiveOriginal!==i;l.useEffect(()=>{a&&t.isActiveOriginal===i&&S.rulesStatus.delete(Number(n))},[i,n,a,t.isActiveOriginal]);const c=l.useCallback(async u=>{var m;o(u.target.checked);const x=await S.rulesStatus.get(Number(n));(!a||t.isActiveOriginal!==u.target.checked)&&await S.rulesStatus.put({...x,id:Number(n),newStatus:u.target.checked,updated_at:new Date,languageId:t.lang_id,qualityProfileId:Number(t.qualityProfile_id),user_email:(m=d().user)==null?void 0:m.email}),r(!0)},[n,a,t.isActiveOriginal,t.lang_id,t.qualityProfile_id]);return e.jsxs(y,{direction:"row",alignItems:"center",children:[e.jsx(f,{minWidth:60,children:i?"Activo":"Inactivo"}),e.jsx(Re,{onChange:c,checked:i}),a&&h?e.jsx(Se,{}):""]})}function Ra(s){const{tags:t,isActive:n,dateSonar:a,ruleTitle:r,ruleDescription:i}=s;return e.jsxs(b,{children:[e.jsxs(y,{padding:2,direction:"column",spacing:2,children:[e.jsxs(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(V,{sx:{backgroundColor:({palette:o})=>o.mode===ne.DARK?o.grey[900]:o.grey[800],color:"white"},label:`Regla ${n?"activo":"inactivo"} desde:`}),e.jsx(V,{label:`${a??"Sin info"}`})]}),e.jsx(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:t.map(o=>e.jsx(V,{label:o},o))})]}),e.jsx(y,{direction:"row",justifyContent:"flex-start",alignItems:"center",padding:2,pb:0,children:e.jsx(Le,{title:r,children:e.jsx(V,{color:"secondary",label:e.jsx(f,{noWrap:!0,variant:"h5",children:r})})})}),e.jsxs(y,{direction:"column",justifyContent:"center",padding:2,children:[e.jsx(y,{direction:"row",justifyContent:"flex-start",children:e.jsx(V,{label:"Descripción de la Regla",sx:{backgroundColor:({palette:o})=>o.mode===ne.DARK?o.grey[900]:o.grey[800],color:"white"}})}),e.jsx(f,{dangerouslySetInnerHTML:{__html:i}})]})]})}var Qe={},kt={exports:{}};(function(s){function t(n){return n&&n.__esModule?n:{default:n}}s.exports=t,s.exports.__esModule=!0,s.exports.default=s.exports})(kt);var It=kt.exports,_e={};const Aa=Zt(Vt);var Je;function Pt(){return Je||(Je=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=Aa}(_e)),_e}var La=It;Object.defineProperty(Qe,"__esModule",{value:!0});var Tt=Qe.default=void 0,Fa=La(Pt()),Ea=e,Ma=(0,Fa.default)((0,Ea.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"History");Tt=Qe.default=Ma;function Oa({comments:s}){return e.jsx(Ts,{sx:{[`& .${Rs.root}:before`]:{flex:0,padding:0}},children:s.map(t=>e.jsxs(As,{children:[e.jsxs(Ls,{children:[e.jsx(Fs,{color:"primary",children:e.jsx(Tt,{})}),e.jsx(Es,{})]}),e.jsx(Ms,{children:e.jsxs(b,{sx:{textAlign:"left"},children:[e.jsx(f,{variant:"subtitle2",sx:{fontSize:"1rem",fontWeight:"bold",color:"black"},children:t.timestamp}),e.jsx(f,{variant:"body1",children:t.author}),e.jsx(f,{variant:"body1",children:t.content})]})})]},t.id))})}var ze={},Da=It;Object.defineProperty(ze,"__esModule",{value:!0});var Rt=ze.default=void 0,Na=Da(Pt()),qa=e,Ba=(0,Na.default)((0,qa.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");Rt=ze.default=Ba;const At=({title:s,result:t})=>{const n=Fe(),a=Zs(async({target:i})=>{var o;return await S.saveDescription({...t,user_email:(o=n().user)==null?void 0:o.email},i.value)},500),r=()=>{};return e.jsxs(e.Fragment,{children:[e.jsx(f,{sx:{fontStyle:"italic",fontWeight:900},children:"Sustento de la propuesta"}),e.jsx(vs,{multiline:!0,fullWidth:!0,defaultValue:t.description,title:s,placeholder:"Esta regla aún no ha tenido observaciones",onChange:a}),e.jsx(Le,{title:"Editar propuesta",children:e.jsx(z,{onClick:r,sx:{background:({palette:i})=>i.primary.light,zIndex:500},children:e.jsx(Rt,{})})})]})},Qa=[{tab:"description",content:({result:s})=>e.jsx(Ra,{tags:[s.severity,s.type],isActive:s.isActive,ruleTitle:s.name,ruleDescription:s.htmlDesc})},{tab:"history",content:()=>{const s=fn(8);return e.jsxs(b,{height:"100%",display:"flex",flexDirection:"column",children:[e.jsx(b,{flexGrow:1,overflow:"auto",flexBasis:"75%",children:e.jsx(Oa,{comments:s})}),e.jsx(oe,{}),e.jsx(b,{height:"30%",overflow:"auto",p:2,children:e.jsx(y,{direction:"row",pr:2,children:e.jsx(At,{result:{id:"1",created_at:new Date,isActive:!0,isActiveSonar:!1,qualityProfile_id:"profile-id",rule_id:"rule-id",updated_at:new Date,key:"rule-key",lang_id:"language-id",name:"rule-name",user_email:"user@example.com"},title:"Sustento de la propuesta"})})})]})}}],za=({isDrawerOpen:s,setIsDrawerOpen:t,result:n})=>{const[a,r]=l.useState("");l.useEffect(()=>{s||r("")},[s]);const i=c=>{c.stopPropagation(),t(!s),a==="description"&&r("")},o=(c,u)=>{r(u)},d=c=>{c.stopPropagation()},h=Qa.find(c=>c.tab===a);return e.jsxs(rt,{anchor:"right",open:s,onClose:i,onClick:d,PaperProps:{style:{width:"42.5%"}},children:[e.jsxs(Os,{value:a,onChange:o,variant:"fullWidth","aria-label":"Drawer tabs",children:[e.jsx($e,{label:"Descripción de Reglas",value:"description"}),e.jsx($e,{label:"Historial de Cambios",value:"history"})]}),h&&h.content({result:n})]})};var Lt={exports:{}};(function(s,t){(function(n,a){s.exports=a()})(Pe,function(){return function(n,a,r){r.updateLocale=function(i,o){var d=r.Ls[i];if(d)return(o?Object.keys(o):[]).forEach(function(h){d[h]=o[h]}),d}}})})(Lt);var Ua=Lt.exports;const $a=tt(Ua);var Ft={exports:{}};(function(s,t){(function(n,a){s.exports=a()})(Pe,function(){return function(n,a,r){n=n||{};var i=a.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function d(c,u,x,m){return i.fromToBase(c,u,x,m)}r.en.relativeTime=o,i.fromToBase=function(c,u,x,m,g){for(var p,I,J,X=x.$locale().relativeTime||o,Z=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],Ce=Z.length,E=0;E<Ce;E+=1){var j=Z[E];j.d&&(p=m?r(c).diff(x,j.d,!0):x.diff(c,j.d,!0));var C=(n.rounding||Math.round)(Math.abs(p));if(J=p>0,C<=j.r||!j.r){C<=1&&E>0&&(j=Z[E-1]);var M=X[j.l];g&&(C=g(""+C)),I=typeof M=="string"?M.replace("%d",C):M(C,u,j.l,J);break}}if(u)return I;var O=J?X.future:X.past;return typeof O=="function"?O(I):O.replace("%s",I)},i.to=function(c,u){return d(c,u,this,!0)},i.from=function(c,u){return d(c,u,this)};var h=function(c){return c.$u?r.utc():r()};i.toNow=function(c){return this.to(h(this),c)},i.fromNow=function(c){return this.from(h(this),c)}}})})(Ft);var Va=Ft.exports;const Ha=tt(Va);var Wa={exports:{}};(function(s,t){(function(n,a){s.exports=a(Xs)})(Pe,function(n){function a(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var r=a(n),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(o){return o+"º"}};return r.default.locale(i,null,!0),i})})(Wa);G.extend($a);G.locale("es");G.extend(Ha);G.updateLocale("es",{relativeTime:{future:"en %s",past:"hace %s",s:"1 s",m:"1 min",mm:"%d min",h:"1 h",hh:"%d h",d:"1 d",dd:"%d d",M:"1 M",MM:"%d M",y:"1 Y",yy:"%d Y"}});const Ya=s=>G(s).from(new Date),Ka=({resource:s,value:t,result:n,secondaryValue:a})=>{const[r,i]=l.useState(!1),o=()=>{i(!r)};return s==="isActiveSonar"?e.jsx(f,{children:t?"Activo":"Inactivo"}):s==="htmlDesc"?e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:o,children:e.jsx(Ze,{})}),e.jsx(za,{isDrawerOpen:r,setIsDrawerOpen:i,result:n})]}):s==="updated_at"?Math.abs(G(String(t)).diff(a,"hours"))>6?e.jsx(f,{align:"left",children:Ya(String(t))}):e.jsx(f,{align:"left",children:"--"}):e.jsx(Ta,{initialStatus:!!t,result:n,id:n.id})},Ga=({colSpan:s})=>e.jsx(_,{colSpan:s,children:e.jsx(b,{display:"grid",sx:{placeContent:"center",minHeight:400},children:e.jsx(je,{})})}),Ja=({icon:s,primaryText:t,secondaryText:n})=>e.jsxs(y,{direction:"column",justifyContent:"center",alignItems:"center",minHeight:"50vh",sx:{fontSize:100},gap:8,children:[s,e.jsxs(y,{direction:"column",gap:4,children:[e.jsx(f,{color:"GrayText",variant:"h3",children:t}),n&&e.jsx(f,{textAlign:"center",color:"GrayText",variant:"body1",children:n})]})]}),Xa=({hasContent:s,children:t,colSpan:n})=>s?e.jsx(e.Fragment,{children:t}):e.jsx(Y,{children:e.jsx(_,{colSpan:n,children:e.jsx(Ja,{icon:e.jsx(Ht,{color:"disabled",fontSize:"inherit"}),primaryText:"Sin datos",secondaryText:"Selecciona filtros"})})}),Za=({children:s,collapseContent:t,colSpan:n})=>{const[a,r]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Y,{sx:{cursor:"pointer",":hover":{backgroundColor:({palette:i})=>i.grey[400]}},onClick:()=>{r(i=>!i)},children:s}),e.jsxs(Y,{children:[e.jsx(_,{padding:a?"normal":"none",colSpan:2}),e.jsx(_,{colSpan:n,padding:a?"normal":"none",children:e.jsx(Ds,{in:a,children:t})})]})]})};function er(){const[s,t,{data:n,isFetching:a,total:r,page:i,rowsPerPage:o}]=ua(),d=l.useCallback((c,u)=>{c&&s(u+1)},[s]),h=l.useCallback(c=>{t(parseInt(c.target.value,10)),s(1)},[s,t]);return e.jsxs(e.Fragment,{children:[e.jsx(ft,{body:a?e.jsx(Ga,{colSpan:se.length}):e.jsx(Xa,{hasContent:!!(n!=null&&n.length),colSpan:se.length,children:a?[]:n==null?void 0:n.map(c=>e.jsx(Za,{colSpan:se.length-2,collapseContent:e.jsx(y,{direction:"row",pr:2,children:e.jsx(At,{result:c,title:`${c.id}-comments`})}),children:se.map(({resource:u,especialConfig:x,textAlign:m})=>x?e.jsx(_,{sx:{textAlign:m??"center"},children:e.jsx(Ka,{result:c,resource:u,secondaryValue:c.created_at,value:c[u]??"--"})},u+c.id):e.jsx(_,{sx:{textAlign:m??"center",maxWidth:140},children:e.jsx(Le,{title:String(c[u]??"--"),children:e.jsx(f,{noWrap:!0,sx:{...u==="key"?{width:60}:{}},children:pn(String(c[u]??"--"),u==="key")})})},u+c.id))},c.id))}),header:e.jsx(Pa,{data:se})}),e.jsx(b,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(ws,{rowsPerPage:o,count:r??1e3,page:i-1,onPageChange:d,onRowsPerPageChange:h,labelRowsPerPage:"Filas por página"})})]})}const tr=({content:s})=>e.jsx("div",{style:{position:"sticky",bottom:20,left:"90vw",width:40,display:"flex",justifyContent:"flex-end",zIndex:500},children:s}),sr=({label:s,labelId:t,inputProps:n,config:a})=>e.jsx(fe,{labelId:t,label:s,sx:{width:200},defaultValue:"all",displayEmpty:!0,inputProps:n,children:a==null?void 0:a.map(({value:r,label:i})=>e.jsx(k,{value:r,children:i},i))}),nr=[{id:"type-uncontrolled",label:"Type",registerField:"type",config:wt},{id:"severity-uncontrolled",label:"Severity",registerField:"severity",config:_t},{id:"state-uncontrolled",label:"State",registerField:"state",config:St}],ar=({handleChanges:s,text:t,inputProps:n,includeAllOptions:a})=>{const{data:r,isFetching:i}=yt(t==="all"?"":t);if(i)return e.jsx(je,{});const[o]=r??[];return e.jsxs(P,{sx:{width:200},children:[e.jsx(T,{id:"qualityProfile-uncontrolled",children:"Quality Profile"}),e.jsxs(fe,{inputProps:n,onChange:s,label:"Quality Profile",labelId:"qualityProfile-uncontrolled",defaultValue:a?"all":o==null?void 0:o.id,children:[a&&e.jsx(k,{value:"all",children:"Todos"}),r==null?void 0:r.map(({id:d,name:h})=>e.jsx(k,{value:d,children:h},d))]})]})},rr=({handleClose:s,isOpen:t})=>{const{register:n,handleSubmit:a}=Ee(),[r,i]=l.useState(),[o,d]=l.useState(!0),h=l.useCallback(async u=>await De().downloadReport({lang_id:u.language_id,qualityProfile_id:u.qualityProfile_id,severity:u.severity,type:u.type,isActiveSonar:u.state},u.showOnlyIsActiveDifferences),[]),c=l.useCallback(u=>{i(u.target.value)},[]);return e.jsx(rt,{variant:"persistent",onClose:s,anchor:"right",open:t,children:e.jsx(y,{sx:{minWidth:400},component:"form",onSubmit:a(h),children:e.jsxs(at,{children:[e.jsx(te,{children:e.jsx(_s,{control:e.jsx(Re,{...n("showOnlyIsActiveDifferences"),checked:!o,onChange:u=>d(!u.target.checked)}),label:"Solo estados propuestos"})}),e.jsx(oe,{}),e.jsx(te,{children:e.jsx(bt,{includeAllOption:o,inputProps:n("language_id"),className:"generic-filter-uncontrolled",handleChange:c})}),e.jsx(te,{children:e.jsx(ar,{includeAllOptions:o,text:r,inputProps:n("qualityProfile_id")})}),o&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),nr.map(({id:u,label:x,registerField:m,config:g})=>e.jsx(te,{children:e.jsxs(P,{sx:{width:200},children:[e.jsx(T,{id:u,children:x}),e.jsx(sr,{config:g,label:x,labelId:u,inputProps:n(m)})]})},u+x))]}),e.jsx(oe,{}),e.jsx(te,{children:e.jsx(D,{type:"submit",variant:"contained",startIcon:e.jsx(et,{}),sx:{width:"100%"},children:"Descargar"})})]})})})},ir=()=>{const[s,t]=l.useState(!1),n=l.useCallback(()=>{t(!0)},[]),a=l.useCallback(()=>{t(!1)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{onClick:n,children:[e.jsx(pe,{children:e.jsx(et,{})}),e.jsx(xe,{children:"Descarga Personalizada"})]}),e.jsx(rr,{handleClose:a,isOpen:s})]})},or=()=>{const[s]=ha();return e.jsxs(k,{onClick:s,children:[e.jsx(pe,{children:e.jsx(Wt,{fontSize:"small"})}),e.jsx(xe,{children:"Restaurar"})]})},lr=()=>{const[s,t]=l.useState(null),n=l.useRef(null),a=ia(),r=l.useCallback(()=>{t(null)},[]);l.useEffect(()=>{t(a?n.current:null)},[a]);const i=l.useCallback(({currentTarget:o})=>{t(o)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(tn,{children:e.jsx(z,{ref:n,onClick:i,sx:{background:({palette:o})=>o.secondary.main,zIndex:500},className:"dragableMenu",children:e.jsx(Yt,{fontSize:"large"})})}),e.jsxs(Ae,{className:"menuDragable",anchorEl:s,open:!!s,onClose:r,children:[e.jsx(jt,{}),e.jsx(ir,{}),e.jsx(or,{})]})]})},cr=()=>{const s=Ne(),t=xt(),[n,a]=l.useState(),[r]=en(n,1e3),i=l.useMemo(()=>s&&t,[s,t]),o=l.useCallback(({target:d})=>{a(d.value)},[]);return l.useEffect(()=>{a(""),Ke()},[s,t]),l.useEffect(()=>{Ke(r)},[r]),e.jsx(Ss,{value:n,disabled:!i,onChange:o,startAdornment:e.jsx(Kt,{})})};function ur(){return e.jsxs(Te,{children:[e.jsxs(b,{display:"flex",flexDirection:"column",gap:2,pt:6,pb:2,children:[e.jsxs(b,{display:"flex",gap:1.5,children:[e.jsx(Gt,{}),e.jsx(f,{fontSize:{xs:"16px",md:"17px"},children:"Activa o desactiva los switches dependiendo si deseas habilitar la regla o no"})]}),e.jsxs(b,{display:"flex",gap:1.5,children:[e.jsx(Jt,{}),e.jsx(f,{fontSize:{xs:"16px",md:"17px"},children:"Recuerda que los estados que propongas no se aplicarán de inmediato en SonarQube"})]})]}),e.jsx(y,{direction:"column",gap:4,marginTop:4,children:e.jsxs(b,{display:"flex",gap:4,children:[e.jsx(Ca,{}),e.jsx(va,{}),e.jsx(cr,{})]})}),e.jsx(er,{}),e.jsx(tr,{content:e.jsx(lr,{})})]})}const dr=({children:s,redirectPath:t="/home"})=>ut()()?e.jsx(e.Fragment,{children:s}):e.jsx(ct,{to:t}),hr=Bs,gr=()=>e.jsx(hr,{children:e.jsxs(Us,{authName:"_auth",authType:"localstorage",children:[e.jsx(ya,{}),e.jsxs(qs,{children:[e.jsx(ae,{path:"/",element:e.jsx(ct,{to:"/admin"})}),e.jsx(ae,{path:"/admin",element:e.jsx(dr,{children:e.jsx(ur,{})})}),e.jsx(ae,{path:"/home",element:e.jsx(An,{})}),e.jsx(ae,{path:"*",element:e.jsx(On,{})})]})]})});function mr(){return e.jsx(b,{display:"flex",flexDirection:"column",minHeight:"100vh",children:e.jsx(ss,{children:e.jsx(rn,{children:e.jsx(gr,{})})})})}const pr="pacifico.dev.com";sn("ctrl+m",s=>{s.preventDefault(),ra(!0)});window.woopra.config({domain:pr,outgoing_tracking:!0,download_tracking:!0,click_tracking:!0}),window.woopra.track();ke.createRoot(document.getElementById("root")).render(e.jsx(es.StrictMode,{children:e.jsx(Js,{steps:[{selector:".language",content:"Selecciona el lenguaje de programación del cual deseas consultar reglas."},{selector:".mainFilters",content:"Ahora procede a seleccionar el perfil a consultar"},{selector:".actualState",content:"Este es el estado actual de la regla en Sonarqube. Las reglas activas son las que analizan los repositorios."},{selector:".proposedState",content:"Aquí podrás proponer si una regla debe estar activada o desactivada, recuerda que tu propuesta no se verá reflejada en SonarQube inmediatamente."},{selector:".dragableMenu",content:e.jsxs(f,{children:["Las opciones de descarga y guardado se encuentran en este botón. Si no lo encuentras rápido, ubícalo con ",e.jsx("kbd",{children:"ctrl"})," +"," ",e.jsx("kbd",{children:"m"}),", ¡también lo puedes mover por toda la pantalla!"]})}],children:e.jsx(Vs,{client:qe,children:e.jsx(mr,{})})})}));
