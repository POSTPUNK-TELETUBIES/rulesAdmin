var Ne=Object.defineProperty;var Ue=(n,e,s)=>e in n?Ne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var f=(n,e,s)=>(Ue(n,typeof e!="symbol"?e+"":e,s),s);import{N as be,j as t,a5 as qe,a6 as me,a7 as Qe,a8 as Ve,a9 as ze,aa as $e,ab as Ke,ac as He,ad as We,ae as Ge}from"./@mui/icons-material-b88151fa.js";import{a as Je,r as o,b as Xe}from"./vendor-b612640b.js";import{c as ce,_ as Ye}from"./@supabase/supabase-js-711ba96a.js";import{u as Ce,C as Ze,P as et,B as Q,T as tt,a as st,b as nt,c as at,d as rt,M as Se,L as ve,e as ke,D as it,f as ot,g as ct,h as pe,i as $,j as fe,k as lt,l as ut,m as dt,S as k,n as ht,A as gt,o as le,p as mt,q as pt,r as ft,s as yt,t as xt,F as L,I as E,O as F,v as jt,w as ne}from"./@mui/material-d4ab1316.js";import{w as wt,s as ae,x as _,P as bt,b,C as Ct,u as Ie,y as St,z as vt,S as kt}from"./@mui/lab-d8569c0b.js";import{$ as It}from"./dexie-3976de5d.js";import{d as Pt}from"./dexie-react-hooks-0c2ddb12.js";import{a as Tt}from"./axios-760d4776.js";import{p as At}from"./papaparse-e84842e1.js";import{c as C}from"./@react-rxjs/utils-24ca515a.js";import{b as S}from"./@react-rxjs/core-1a0bb4f0.js";import{Q as Ot,u as Pe,a as Rt}from"./@tanstack/react-query-7cfe65c4.js";import{u as Te}from"./react-hook-form-c6612ec3.js";import{u as Lt,S as Et}from"./notistack-f20782e6.js";import{T as Ft}from"./@reactour/tour-e24be7d6.js";import{h as _t}from"./hotkeys-js-d20e5801.js";import"./@emotion/react-0d101b94.js";import"./@emotion/styled-6b07d811.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var re={},ye=Je;re.createRoot=ye.createRoot,re.hydrateRoot=ye.hydrateRoot;var ue=(n=>(n.DARK="dark",n.LIGTH="light",n))(ue||{});const Ae={fontFamily:["Foco"].join(",")},Mt=be({palette:{mode:"dark"},typography:{...Ae}}),Bt=be({palette:{mode:"light",primary:{main:"#0099CC"},secondary:{main:"#EE2C70"}},typography:{...Ae}}),Oe=o.createContext({toggleColorMode(){}}),Dt=({app:n})=>{const e=Ce("(prefers-color-scheme: dark)"),[s,a]=o.useState(localStorage.getItem("mode")||(e?"light":"dark")),r=o.useMemo(()=>({toggleColorMode(){a(i=>i==="dark"?"light":"dark")}}),[]);return o.useEffect(()=>{localStorage.setItem("mode",s)},[s]),t.jsx(Oe.Provider,{value:r,children:t.jsxs(wt,{theme:s==="dark"?Mt:Bt,children:[t.jsx(Ze,{}),n]})})},P=class extends It{constructor(){super("syncro");f(this,"rulesStatus");this.version(5).stores({rulesStatus:"id, updated_at, newStatus, language, qualityProfileId, description, user_email"})}static getInstance(){return P.instance??(P.instance=new P),P.instance}async getLocalRules(s){return await this.rulesStatus.where("id").anyOf(s).toArray()}async countAllRules(){return await this.rulesStatus.count()}async saveDescription(s,a){const r=await this.rulesStatus.get(s.id);return await this.rulesStatus.put({id:Number(s.id),languageId:s.lang_id,newStatus:s.isActive,qualityProfileId:Number(s.qualityProfile_id),...r,updated_at:new Date,...a?{description:a}:{},user_email:s.user_email})}async getRulesToUpdate(){return await this.rulesStatus.toArray()}};let K=P;f(K,"instance");const M=K.getInstance(),Nt={width:"80vh",maxWidth:600,minWidth:400,height:"80vh",minHeight:400,borderRadius:50},Ut=o.memo(function({popoverBody:n,icon:e,sxProps:s,textButton:a,buttonProps:r}){const[i,c]=o.useState(null),l=o.useCallback(u=>{u.stopPropagation(),c(u.currentTarget)},[]),d=o.useCallback(u=>{u.stopPropagation(),c(null)},[]);return t.jsxs(t.Fragment,{children:[a?t.jsx(_,{startIcon:e,onClick:l,...r,children:a}):t.jsx(ae,{onClick:l,sx:{margin:"auto"},children:e}),t.jsxs(et,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:s??Nt,open:!!i,onClose:d,anchorEl:i,children:[t.jsx(ae,{onClick:d,sx:{position:"absolute",top:0,right:0},children:t.jsx(qe,{sx:{fontSize:"medium"}})}),t.jsx(Q,{margin:1,children:n})]})]})});var H=(n=>(n.FIRST_VISIT="firstVisit",n.TIMES_VISIT="timesVisit",n))(H||{});class qt extends Error{constructor(e){super(`${e} is required, please do check .envexample to provide one similar into .env file`)}}const Re=n=>{const e={VITE_SUPABASE_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndyaXBhbnFobXdnbnJua25iZ2tiIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODcyMTU5NDksImV4cCI6MjAwMjc5MTk0OX0.FUBAfuwsSF69KLApkOttj3RLHDaQ4d6pBJujZnrLOzk",VITE_WOOPRA_DOMAIN:"pacifico.dev.com",VITE_SUPABASE_URL:"https://wripanqhmwgnrnknbgkb.supabase.co",VITE_TYPE_CLIENT:"supabase",BASE_URL:"/rulesAdmin",MODE:"production",DEV:!1,PROD:!0,SSR:!1}[n];if(!e)throw new qt(n);return e},sn=(n,e=!0,s=document.body)=>{const a=s.querySelector(n);a&&(a.style.overflow=e?"hidden":"auto")},Qt=n=>n<=3,nn=()=>{const n=localStorage.getItem(H.TIMES_VISIT);if(Qt(Number(n)))return localStorage.setItem(H.FIRST_VISIT,new Date().toDateString()),localStorage.setItem(H.TIMES_VISIT,((Number(n)||0)+1).toString()),!0},xe=n=>n!=null,Vt={css:1,java:1,web:1,Web:1,javascript:1,typescript:1},zt=(n,e=Vt)=>{const[s]=n.match(/^.+:/);return e[s.substring(0,s.length-1)]?n.replace(s,""):n},an=(n,e,s)=>e?zt(n,s):n,ie=(n,e,s)=>n?e:s,de=(n,e,s)=>n==null?void 0:n.reduce((a,r)=>(a[String(r[e])]=s?r[s]:r,a),{}),$t=()=>{const n=new Date;return n.setUTCHours(0),n.setUTCMinutes(0),n},Le=(n,e,s=!0)=>{if(!s)return window[n]=e};Le("keyBy",de);Le("renderConditional",ie);const rn=n=>{const e=[],s=new Date;for(let a=0;a<n;a++){s.setMinutes(s.getMinutes()-a);const r={id:a+1,author:"asda",timestamp:"asdsa",content:"asdasdsad"};e.push(r)}return e},Z=Re("VITE_SUPABASE_TOKEN"),ee=Re("VITE_SUPABASE_URL"),Kt="supabase",T=class{constructor(e){this.client=e}getConflicts(e){throw new Error("Method not implemented.")}getByRuleName(e,s,a){throw new Error("Method not implemented.")}downloadReport(e){throw new Error("Method not implemented.")}postNewStatus(e){throw new Error("Method not implemented.")}async getTotalCountByTable(e){return 100}static getInstance(){return T.instance??(T.instance=new T(Tt.create({baseURL:ee,headers:{apiKey:Z}}))),T.instance}async getPaginatedRulesByFilter(e,s){const{data:a}=await this.client.get("/rules",{params:{...e,...s}});return{data:a,count:100}}async getQualityProfilesByLanguage(e){const{data:s}=await this.client.get("/qualityprofiles",{params:{language_id:e}});return s}async getAllLanguages(){const{data:e}=await this.client.get("/languages");return e}};let W=T;f(W,"instance");const Ht=W.getInstance,A=class{static getInstance(){return A.instance??(A.instance=new A),A.instance}parseReport(e){const s=e.map(({rules:a,qualityprofiles:r,...i})=>({...a,...r,...i,ruleKey:a.key,qualityProfileName:r.name,ruleName:a.name}));return At.unparse(s,{columns:["qualityProfileName","ruleKey","ruleName","severity","type","updated_at","created_at","description","isActiveSonar","isActive","user_email"]})}};let G=A;f(G,"instance");const Wt=G.getInstance(),w=class{constructor(e,s=Wt){this.client=e,this.reportGenerator=s}static getInstance(e){return w.instance??(w.instance=new w(e??ce(ee,Z))),w.instance}async getConflicts(e){const s=$t().toISOString(),a=this.client.from("status").select(`
        *,
        qualityprofiles(
        *
        ),
        rules!inner(
          *
      )
      `).in("id",e.map(({id:l})=>l)).gt("updated_at",s).throwOnError(),{data:r}=await a,i=de(r,"id");return e.filter(({id:l,newStatus:d})=>{var u,m;return xe((u=i[l])==null?void 0:u.isActive)&&((m=i[l])==null?void 0:m.isActive)!==d}).map(l=>{const{rules:d,...u}=i[l.id];return{...d,...u,...l}})}async getCSVReportUpdatables(e){const{data:s}=await this.client.rpc("get_changed_q",{quality_id:Number(e)}).select("*").csv().throwOnError();return s}async getCSVCompleteFiltered(e){const{data:s}=await this.prepareFilteredQuery(e).throwOnError();return this.reportGenerator.parseReport(s)}async downloadReport(e,s=!0){const a=s?await this.getCSVReportUpdatables(Number(e.qualityProfile_id)):await this.getCSVCompleteFiltered(e),r=document.createElement("a");r.download="report";const i=URL.createObjectURL(new Blob([a],{type:"text/csv"}));r.href=i,r.click(),URL.revokeObjectURL(i),r.remove()}changeIsActive(e,s=!0){if(!e.length)return;const[{user_email:a}]=e;return this.client.from("status").update({isActive:s,updated_at:new Date,user_email:a}).in("id",e.map(({id:r})=>r)).throwOnError()}async bulkUpdateDescription(e){if(!e.length)return;const{data:s}=await this.client.auth.getUser();return await this.client.from("status").upsert(e.map(({id:a,description:r,qualityProfileId:i})=>{var c;return{id:a,description:r,qualityProfile_id:i,user_email:(c=s.user)==null?void 0:c.email}})).select().throwOnError()}async postNewStatus(e){const s=e.filter(({newStatus:i})=>!i),a=e.filter(({newStatus:i})=>i),r=e.filter(({description:i})=>!!i);await Promise.all([this.changeIsActive(s,!1),this.changeIsActive(a,!0),this.bulkUpdateDescription(r)])}async getTotalCountByTable(e){const{count:s}=await this.client.from(e).select("*",{count:"exact",head:!0}).throwOnError();return s??0}getQualityProfilesByLanguageQuery(e){return this.client.from("qualityprofiles").select().eq("language_id",e).throwOnError()}async getQualityProfilesByLanguage(e){const{data:s}=await this.getQualityProfilesByLanguageQuery(e);return s}buildQuery(e,s){for(const a in s){if(!Object.prototype.hasOwnProperty.call(s,a))continue;const r=s[a];r!=="all"&&xe(r)&&(e=e.eq(w.queryBuilderColumns[a],r))}return e}prepareFilteredQuery(e){delete e.lang_id;const s=this.client.from("status").select(`
        *,
        qualityprofiles(
          *
        ),
        rules!inner(
          *
        )
      `,{count:"exact"});return this.buildQuery(s,e)}getPaginatedRulesByFilterQuery(e,s){return this.prepareFilteredQuery(e).range(...this.getRange(s)).order("id",{ascending:!0}).throwOnError()}async getPaginatedRulesByFilter(e,s){const{data:a,count:r}=await this.getPaginatedRulesByFilterQuery(e,s);return{data:a,count:r}}getAllLanguagesQuery(){return this.client.from("languages").select().throwOnError()}async getAllLanguages(){const{data:e}=await this.getAllLanguagesQuery();return e.filter(({name:s})=>w.whiteList[s])}getRange({page:e,limit:s=10}){return[(e-1)*s,e*s-1]}async getByRuleName(e,s,a){const{data:r,count:i}=await this.prepareFilteredQuery(s).ilike("rules.name",`%${e}%`).range(...this.getRange(a)).order("id",{ascending:!0}).throwOnError();return{data:r,count:i}}subscribeChanges(e){return this.client.channel("changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"status"},e).subscribe()}};let R=w;f(R,"instance"),f(R,"whiteList",{ts:!0,js:!0,css:!0,java:!0,web:!0}),f(R,"queryBuilderColumns",{severity:"rules.severity",type:"rules.type",isActiveSonar:"isActiveSonar",qualityProfile_id:"qualityProfile_id"});const Ee=R.getInstance,se=void 0,Gt=se==null?void 0:se.serverInit();window.mockServer=Gt;const Fe=ce(ee,Z),Jt={axios:Ht,supabase:()=>Ee(Fe)},q=Jt[Kt](),[Xt,on]=C(),[Yt]=S(Xt,""),[Zt,cn]=C(),[es]=S(Zt,"all"),[ts,ln]=C(),[ss]=S(ts,null),[ns,un]=C(),[as]=S(ns,"all"),[rs,dn]=C(),[is]=S(rs,""),[os,cs]=C();S(os,0);const[ls,Y]=C(),[us]=S(ls,1),[ds,hs]=C(),[hn]=S(ds,!1),[gs,gn]=C(),[ms]=S(gs,null),he=new Ot({defaultOptions:{queries:{staleTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1,_optimisticResults:"optimistic"}}}),v=class{constructor(){if(v.instance)throw new Error("Singleton")}static getInstance(){return v.instance??(v.instance=new v),v.instance}get tokenData(){return{token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken")}}set tokenData(e){Object.keys(e).forEach(s=>localStorage.setItem(s,e[s]))}clean(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}};let J=v;f(J,"instance");const O=class{constructor(e,s=J.getInstance()){f(this,"isLogged");f(this,"user");this.client=e,this.authStorage=s}async singUp({email:e,firstName:s,lastName:a,password:r,username:i}){const{data:c,error:l}=await this.client.signUp({email:e,password:r,options:{data:{first_name:s,last_name:a,username:i}}});if(l)throw l;return c}static getInstance(e){return O.instance??(O.instance=new O(e??ce(ee,Z).auth)),O.instance}setToken(e){this.authStorage.tokenData={refreshToken:e.refresh_token,token:e.access_token}}async login(e,s){const{data:a,error:r}=await this.client.signInWithPassword({email:e,password:s});if(r)throw r;return this.setToken(a.session),this.isLogged=!0,this.user=a.user,a}async verifyAuth(e){const{data:s,error:a}=await this.client.getUser(e);if(a)throw a;return s}async logOut(e){const{error:s}=await this.client.signOut();if(s)throw s;return this.user=null,this.authStorage.clean(),e}async getPermissions(){const{data:e,error:s}=await this.client.mfa.getAuthenticatorAssuranceLevel();if(s)throw s;return e}async checkAuth(e,s){const a=e??this.authStorage.tokenData.token,r=s??this.authStorage.tokenData.refreshToken;if(!a||!r)return;const{data:i,error:c}=await this.client.setSession({access_token:a,refresh_token:r});if(c)throw c;return this.setToken(i.session),this.isLogged=!0,this.user=i.user,i}};let X=O;f(X,"instance");const I=Object.assign(X.getInstance(Fe.auth),{isLoading:!0}),B=o.createContext(I),ps=()=>{const n=as(),e=Yt(),s=ss(),a=is(),r=es(),i=us(),c=ms();return{severity:n,lang_id:e,isActiveSonar:s,qualityProfile_id:a,type:r,page:i,textMatchFilter:c}},mn=()=>{const{isActiveSonar:n,lang_id:e,page:s,qualityProfile_id:a,severity:r,textMatchFilter:i,type:c}=ps(),[l,d]=o.useState(10),u=o.useRef(0),[m,te]=o.useState([]),[x,h]=o.useState(null),g=!!(e&&a),{data:D,isFetching:_e,isLoading:Me,isRefetching:Be,isFetched:De}=Pe({queryKey:["rules",e,a,c,n,r,s,l,i],async queryFn(){const y={severity:r,lang_id:e,isActiveSonar:n,qualityProfile_id:a,type:c},N={page:s,limit:l},{data:V,count:z}=i?await q.getByRuleName(i,y,N):await q.getPaginatedRulesByFilter(y,N);return u.current=z,cs(z),V},enabled:g,keepPreviousData:!0});o.useEffect(()=>{Y(1)},[c,r,n,a,i]);const ge=o.useCallback(async()=>{if(!g)return;const y=D==null?void 0:D.map(({rules:p,...j})=>{var U;return{...p,...j,...Number((U=x==null?void 0:x.new)==null?void 0:U.id)===Number(j.id)?x==null?void 0:x.new:{},isActiveOriginal:j.isActive}}),V=(y?await M.getLocalRules(y.map(({id:p})=>Number(p))):[]).reduce((p,j)=>(p[j.id]=j,p),{}),z=y==null?void 0:y.map(p=>{var j,U;return{...p,isActive:((j=V[p.id])==null?void 0:j.newStatus)??p.isActive,description:((U=V[p.id])==null?void 0:U.description)??p.description}});te(z)},[D,g,x]);return o.useEffect(()=>{ge()},[D,s,ge]),o.useEffect(()=>{const y=Ee().subscribeChanges(N=>h({...N}));return()=>{y.unsubscribe()}},[]),[Y,d,{data:m,isFetching:_e,isLoading:Me,total:u.current,page:s,isFetched:De,rowsPerPage:l,isRefetching:Be}]},fs=()=>{const[n,e]=o.useState(!1);return[o.useCallback(async a=>{e(!0);const r=await M.rulesStatus.toArray(),i=a?r.filter(({id:c})=>a[Number(c)]):r;await q.postNewStatus(i),await M.rulesStatus.clear(),await he.invalidateQueries({queryKey:["rules"]}),Y(1),e(!1)},[]),n]},pn=()=>{const[n,e]=o.useState(!1);return[o.useCallback(async()=>{e(!0),await M.rulesStatus.clear(),await he.invalidateQueries({queryKey:["rules"]}),Y(1),e(!1)},[]),n]},ys=o.memo(function({body:e,header:s,footer:a,stickyHeader:r=!0}){return t.jsxs(bt,{sx:{paddingY:4,background:"transparent"},children:[t.jsx(tt,{sx:{maxHeight:"80vh"},children:t.jsxs(st,{stickyHeader:r,children:[t.jsx(nt,{children:s}),t.jsx(at,{sx:{backgroundColor:({palette:i})=>i.mode===ue.DARK?i.grey[800]:i.grey[300]},children:e}),a&&e&&t.jsx(rt,{children:a})]})}),!e&&t.jsx("div",{children:"asdsadsadsda"})]})}),je=[{resource:"key",label:"Codigo"},{resource:"name",label:"Regla"},{resource:"newStatus",label:"Estado local"}],xs=()=>{const[n]=fs(),[e,s]=o.useState(!1),[a,r]=o.useState([]),i=o.useRef({}),[c,l]=o.useState(!1),d=o.useCallback(()=>{s(!1)},[]),u=o.useCallback(()=>{const{current:h}=i,g=Object.values(h).length?h:void 0;n(g),d()},[n,d]),m=o.useCallback(async()=>{const h=await M.getRulesToUpdate(),g=await q.getConflicts(h);if(r(g),g!=null&&g.length)return s(!0);u()},[u]),te=o.useCallback((h,g)=>{if(g.target.checked)return i.current[h]=!0;delete i.current[h]},[]),x=o.useCallback(h=>{l(h.target.checked)},[]);return t.jsxs(t.Fragment,{children:[t.jsxs(Se,{onClick:m,children:[t.jsx(ve,{children:t.jsx(me,{fontSize:"small"})}),t.jsx(ke,{children:"Sincronizar"})]}),t.jsxs(it,{onClose:d,open:e,children:[t.jsx(ot,{children:"Hay conflictos"}),t.jsxs(ct,{children:[t.jsx(ys,{header:t.jsxs(pe,{children:[t.jsx($,{children:t.jsx(fe,{checked:c,onChange:x})}),je.map(({label:h})=>t.jsx($,{children:h},h))]}),body:t.jsx(t.Fragment,{children:a==null?void 0:a.map(h=>t.jsxs(pe,{children:[t.jsx($,{children:t.jsx(fe,{disabled:c,onChange:g=>te(h.id,g)})}),je.map(g=>t.jsx($,{id:`${h.id}-${g.label}`,children:typeof h[g.resource]=="boolean"?h[g.resource]?"Activo":"Inactivo":h[g.resource]}))]},h.id))})}),t.jsx(lt,{children:t.jsx(_,{onClick:u,startIcon:t.jsx(me,{}),children:"Sincronizar"})})]})]})]})},js=()=>q.getAllLanguages(),ws=()=>{var a;const n=Pt.useLiveQuery(()=>M.rulesStatus.toArray()),{data:e}=Pe({queryKey:["languages"],queryFn:js}),s=o.useMemo(()=>de(e,"id","name"),[e]);return t.jsx(Ut,{icon:ie(!(n!=null&&n.length),t.jsx(Ve,{}),t.jsx(Qe,{})),textButton:t.jsx(b,{children:ie(!!(n!=null&&n.length),"Tienes cambios sin sincronizar","No hay cambios sin sincronizar")}),buttonProps:{variant:"contained"},popoverBody:t.jsx(ut,{children:e&&t.jsxs(dt,{children:[(a=n==null?void 0:n.filter(({languageId:r},i,c)=>c.findIndex(({languageId:l})=>l===r)===i))==null?void 0:a.map(({languageId:r},i)=>t.jsx(k,{direction:"row",children:t.jsx(Ct,{label:s[r]})},i)),t.jsx(ht,{children:t.jsx(xs,{})})]})})})},bs=()=>{const{palette:n}=Ie(),e=o.useContext(Oe),{isLogged:s,user:a}=o.useContext(B),[r,i]=o.useState(null),c=o.useContext(B),l=o.useCallback(()=>e.toggleColorMode(),[e]),d=o.useCallback(({currentTarget:m})=>{i(m)},[]),u=o.useCallback(()=>{i(null)},[]);return t.jsxs(t.Fragment,{children:[t.jsx(gt,{sx:{background:({palette:m})=>`linear-gradient(90deg, ${m.primary.main} 80%, ${m.secondary.main} 100%)`},children:t.jsx(le,{children:t.jsxs(mt,{disableGutters:!0,sx:{justifyContent:"space-between"},children:[t.jsxs(Q,{sx:Cs,children:[t.jsx(b,{variant:"h6",fontWeight:900,fontSize:"1.6rem",children:"Sonardash"}),t.jsx(b,{variant:"body1",children:"/ Gestión de Reglas"})]}),s&&t.jsx(ws,{}),t.jsxs(k,{direction:"row",justifyContent:"center",alignItems:"center",children:[(n==null?void 0:n.mode)===ue.DARK?t.jsx(ze,{}):t.jsx($e,{}),t.jsx(pt,{color:"warning",onChange:l}),s&&t.jsx(_,{sx:{borderRadius:"50%"},onClick:d,children:t.jsx(St,{sx:{width:40,height:40},variant:"circular",children:a==null?void 0:a.email[0]})})]})]})})}),t.jsx(ft,{open:!!r,anchorEl:r,onClose:u,children:t.jsx(yt,{children:t.jsxs(Se,{onClick:()=>{c.logOut(),u()},children:[t.jsx(ve,{children:t.jsx(Ke,{})}),t.jsx(ke,{children:"Log out"})]})})})]})},Cs={display:"flex",justifyContent:"center",alignItems:"center",gap:1},Ss="/rulesAdmin/admin.svg",vs="_heroImage_1kfgi_1",ks={heroImage:vs},Is=({handleClose:n,handleOpen:e,isOpen:s,content:a})=>{const r=Ie(),i=Ce(r.breakpoints.up("md"));return t.jsx(xt,{PaperProps:{sx:{justifyContent:"center"}},onOpen:e,onClose:n,open:s,anchor:i?"right":"bottom",children:t.jsx(le,{sx:Ps,children:a})})},Ps={maxWidth:500,width:{md:"50vw"},minHeight:"50vh",display:"grid",placeContent:"center"},oe=({inputProps:n,disabled:e,id:s="password",label:a="Password"})=>{const[r,i]=o.useState(!1),c=o.useCallback(()=>{i(l=>!l)},[]);return t.jsxs(L,{disabled:e,children:[t.jsx(E,{htmlFor:s,children:a}),t.jsx(F,{id:s,type:r?"text":"password",inputProps:n,endAdornment:t.jsx(jt,{position:"end",children:t.jsx(ae,{"aria-label":"toggle password visibility",onMouseDown:l=>l.preventDefault(),edge:"end",onClick:c,children:r?t.jsx(He,{}):t.jsx(We,{})})}),label:a})]})};function Ts(){const n=o.useContext(B),{enqueueSnackbar:e}=Lt();async function s(a,r){try{await n.login(a,r)}catch(i){const{message:c}=i;return e("Credenciales inválidas",{variant:"error",autoHideDuration:3e3}),c}}return s}function As({singUpClick:n,isSingUpAvailable:e}){const{handleSubmit:s,register:a,resetField:r}=Te(),i=Ts(),[c,l]=o.useState(!1),d=o.useCallback(async({email:u,password:m})=>{l(!0),r("password"),i(u,m),l(!1)},[i,r]);return t.jsxs(k,{component:"form",onSubmit:s(d),spacing:2,p:2,children:[t.jsx(Q,{display:"flex",justifyContent:"center",children:t.jsx(Ge,{sx:{fontSize:"10vh",borderRadius:"50%",border:"2px solid gray"}})}),t.jsxs(L,{disabled:c,children:[t.jsx(E,{htmlFor:"email",children:"Email"}),t.jsx(F,{id:"email",label:"Email",inputProps:a("email")})]}),t.jsx(oe,{disabled:c,inputProps:a("password")}),t.jsx(vt,{type:"submit",variant:"contained",disabled:c,loading:c,children:"Login"}),e&&t.jsxs(b,{align:"center",children:["¿Aún no te registras? ",t.jsx(ne,{onClick:n,children:"Sing up"})," "]})]})}const Os=({handleLoginClick:n})=>{const[e,s]=o.useState(!1),[a,r]=o.useState(!1),{register:i,handleSubmit:c}=Te(),l=o.useContext(B),d=o.useCallback(async u=>{s(!0),await l.singUp(u),s(!1),r(!0)},[l]);return a?t.jsx(k,{children:t.jsxs(b,{children:["Revisa tu correo y haz click en el enalnce de confirmacion, si ya lo hiciste, ",t.jsx(ne,{onClick:n,children:"Logueate"})]})}):t.jsxs(k,{component:"form",onSubmit:c(d),spacing:2,children:[t.jsxs(L,{disabled:e,children:[t.jsx(E,{htmlFor:"email",children:"Email"}),t.jsx(F,{id:"email",label:"Email",inputProps:i("email")})]}),t.jsx(oe,{inputProps:i("password")}),t.jsx(oe,{id:"confirmPassword",label:"Confirm Password",inputProps:i("confirmPassword")}),t.jsxs(L,{disabled:e,children:[t.jsx(E,{htmlFor:"username",children:"Username"}),t.jsx(F,{id:"username",label:"Username",inputProps:i("username")})]}),t.jsxs(L,{disabled:e,children:[t.jsx(E,{htmlFor:"lastName",children:"Apellido"}),t.jsx(F,{id:"lastName",label:"Apellido",inputProps:i("lastName")})]}),t.jsxs(L,{disabled:e,children:[t.jsx(E,{htmlFor:"firstName",children:"Nombre"}),t.jsx(F,{id:"firstName",label:"Nombre",inputProps:i("firstName")})]}),t.jsx(_,{type:"submit",variant:"contained",children:"Sing up"}),t.jsxs(b,{align:"center",children:["¿Ya tienes cuenta? ",t.jsx(ne,{onClick:n,children:"Log in"})]})]})},Rs=({isSingUpAvailable:n})=>{const[e,s]=o.useState(!1),[a,r]=o.useState(!0),i=o.useCallback((u=!0)=>()=>{s(!0),r(u)},[]),c=o.useCallback(()=>{s(!1)},[]),l=o.useCallback(()=>{r(!1)},[]),d=o.useCallback(()=>{r(!0)},[]);return t.jsxs(t.Fragment,{children:[t.jsxs(k,{direction:"row",height:"80vh",spacing:2,gap:2,alignItems:"center",justifyContent:"center",children:[t.jsx(Q,{sx:Ls,children:t.jsx("img",{className:ks.heroImage,src:Ss,alt:"admin configuring panel"})}),t.jsxs(k,{spacing:1,width:{sm:"100%",md:"50%"},children:[t.jsx(b,{variant:"h3",component:"h1",children:"Ace config and simplify SonarQube rule administration"}),t.jsx(b,{variant:"body1",children:"Effortlessly Customize SonarQube Rules for Optimal Code Quality"}),t.jsxs(k,{spacing:2,direction:{sm:"column",md:"row"},children:[n&&t.jsx(_,{variant:"contained",onClick:i(!1),children:"Sing up"}),t.jsx(_,{variant:"outlined",onClick:i(),children:"Log in"})]})]})]}),t.jsx(Is,{content:a?t.jsx(As,{singUpClick:l}):t.jsx(Os,{handleLoginClick:d}),handleClose:c,handleOpen:i,isOpen:e})]})},Ls={width:{xs:"0%",md:"50%"},display:{xs:"none",md:"block"}},we=()=>t.jsx(Q,{width:"100%",sx:{display:"grid",placeContent:"center"},children:t.jsx(kt,{animation:"pulse",variant:"rectangular",width:"80vw",height:"50vh"})}),Es=o.lazy(()=>Ye(()=>import("./AdminPanel-5faacf2c.js"),["assets/AdminPanel-5faacf2c.js","assets/@mui/icons-material-b88151fa.js","assets/vendor-b612640b.js","assets/@emotion/react-0d101b94.js","assets/@emotion/styled-6b07d811.js","assets/@reactour/tour-e24be7d6.js","assets/@tanstack/react-query-7cfe65c4.js","assets/@react-rxjs/core-1a0bb4f0.js","assets/@react-rxjs/utils-24ca515a.js","assets/@mui/material-d4ab1316.js","assets/@mui/lab-d8569c0b.js","assets/dayjs-c0cd33fe.js","assets/use-debounce-6bf2a1da.js","assets/react-draggable-25144dc2.js","assets/react-hook-form-c6612ec3.js","assets/@supabase/supabase-js-711ba96a.js","assets/dexie-3976de5d.js","assets/dexie-react-hooks-0c2ddb12.js","assets/axios-760d4776.js","assets/papaparse-e84842e1.js","assets/notistack-f20782e6.js","assets/hotkeys-js-d20e5801.js"]));function Fs(){const{isLogged:n,isLoading:e}=o.useContext(B);return t.jsx(Et,{children:t.jsx(Dt,{app:t.jsxs(t.Fragment,{children:[t.jsx(bs,{}),t.jsxs(le,{sx:{paddingTop:12,minHeight:"100vh"},children:[e&&t.jsx(we,{}),!n&&!e?t.jsx(Rs,{}):t.jsx(o.Suspense,{fallback:t.jsx(we,{}),children:t.jsx(Es,{})})]})]})})})}const _s="pacifico.dev.com",Ms=({children:n})=>{const[e,s]=o.useState(!1),[a,r]=o.useState(!0);o.useEffect(()=>{I.checkAuth().then(c=>{var l;s(!!((l=c==null?void 0:c.user)!=null&&l.id))}).finally(()=>{r(!1)})},[]);const i=o.useMemo(()=>({isLogged:e,isLoading:a,user:I.user,async login(c,l){const d=await I.login(c,l);return s(!0),d},async checkAuth(c,l){return await I.checkAuth(c,l)},async singUp(c){await I.singUp(c)},async logOut(){await I.logOut(),s(!1)}}),[e,a]);return t.jsx(B.Provider,{value:i,children:n})};_t("ctrl+m",n=>{n.preventDefault(),hs(!0)});window.woopra.config({domain:_s,outgoing_tracking:!0,download_tracking:!0,click_tracking:!0}),window.woopra.track();re.createRoot(document.getElementById("root")).render(t.jsx(Xe.StrictMode,{children:t.jsx(Ft,{steps:[{selector:".language",content:"Selecciona el lenguaje de programación del cual deseas consultar reglas."},{selector:".mainFilters",content:"Ahora procede a seleccionar el perfil a consultar"},{selector:".actualState",content:"Este es el estado actual de la regla en Sonarqube. Las reglas activas son las que analizan los repositorios."},{selector:".proposedState",content:"Aquí podrás proponer si una regla debe estar activada o desactivada, recuerda que tu propuesta no se verá reflejada en SonarQube inmediatamente."},{selector:".dragableMenu",content:t.jsxs(b,{children:["Las opciones de descarga y guardado se encuentran en este botón. Si no lo encuentras rápido, ubícalo con ",t.jsx("kbd",{children:"ctrl"})," +"," ",t.jsx("kbd",{children:"m"}),", ¡también lo puedes mover por toda la pantalla!"]})}],children:t.jsx(Ms,{children:t.jsx(Rt,{client:he,children:t.jsx(Fs,{})})})})}));export{B as A,ue as C,sn as D,xs as S,dn as a,ln as b,un as c,cn as d,M as e,q as f,rn as g,mn as h,ys as i,Ee as j,pn as k,hn as l,is as m,gn as n,an as p,on as s,Yt as u,nn as v};
