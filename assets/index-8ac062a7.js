var Te=Object.defineProperty;var ke=(n,t,s)=>t in n?Te(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var _=(n,t,s)=>(ke(n,typeof t!="symbol"?t+"":t,s),s);import{j as e,z as ie,Z as Ie,$ as Pe,a0 as Ee,a1 as Le,a2 as Ae,a3 as Fe,a4 as Oe,a5 as De,a6 as Be,a7 as qe,a8 as Ne,a9 as ze,aa as Qe,ab as Ye}from"./@mui/icons-material-80cc29b0.js";import{a as $e,r as l,d as Z,b as Ve}from"./vendor-b612640b.js";import{c as v}from"./@react-rxjs/utils-24ca515a.js";import{b as w}from"./@react-rxjs/core-1a0bb4f0.js";import{a as Ue}from"./axios-760d4776.js";import{c as He}from"./@supabase/supabase-js-f1992ef7.js";import{u as X,Q as Ge,a as Ke}from"./@tanstack/react-query-7cfe65c4.js";import{C as ee,F as le,I as ce,S as ue,M as T,u as Je,T as We,a as Ze,P as Xe,b as et,c as tt,d as nt,e as st,f as at,g as V,B as rt,h as te,i as ne,j as q,k as p,l as m,m as A,n as B,o as ot,p as it,q as de,r as lt,s as ct,A as ut,t as he,v as dt,L as ge,w as pe}from"./@mui/material-08115744.js";import{u as ht,T as gt}from"./@reactour/tour-e24be7d6.js";import{$ as pt}from"./dexie-3976de5d.js";import{d as mt,a as F}from"./dayjs-c0cd33fe.js";import{d as ft}from"./dexie-react-hooks-0c2ddb12.js";import{c as xt}from"./react-draggable-9b2b0999.js";import{h as yt}from"./hotkeys-js-d20e5801.js";import"./@emotion/react-0d101b94.js";import"./@emotion/styled-6b07d811.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();var G={},ae=$e;G.createRoot=ae.createRoot,G.hydrateRoot=ae.hydrateRoot;const[jt,bt]=v(),[me]=w(jt,""),[Ct,vt]=v(),[fe]=w(Ct,"all"),[wt,St]=v(),[xe]=w(wt,null),[_t,Rt]=v(),[ye]=w(_t,"all"),[Mt,re]=v(),[je]=w(Mt,""),[Tt,kt]=v();w(Tt,0);const[It,K]=v(),[Pt]=w(It,1),[Et,Lt]=v(),[At]=w(Et,!1),be=n=>{const t={VITE_SUPABASE_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZueGZtZnNmdGR3aGlhaGxnb3pnIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODE5NTQ2MjIsImV4cCI6MTk5NzUzMDYyMn0.2-lbg4bjMgp6MxaHUpHd1qTIHoydHr0uXAi78MZ06h4",VITE_WOOPRA_DOMAIN:"pacifico.dev.com",VITE_SUPABASE_URL:"https://fnxfmfsftdwhiahlgozg.supabase.co",VITE_TYPE_CLIENT:"supabase",BASE_URL:"/rulesAdmin",MODE:"production",DEV:!1,PROD:!0,SSR:!1}[n];if(!t)throw new Error(`Not found env ${n}`);return t},Ce=be("VITE_SUPABASE_TOKEN"),ve=be("VITE_SUPABASE_URL"),Ft="supabase",R=class{constructor(t){this.client=t}downloadReport(t){throw new Error("Method not implemented.")}postNewStatus(t){throw new Error("Method not implemented.")}async getTotalCountByTable(t){return 100}static getInstance(){return R.instance??(R.instance=new R(Ue.create({baseURL:ve,headers:{apiKey:Ce}}))),R.instance}async getPaginatedRulesByFilter(t,s){const{data:a}=await this.client.get("/rules",{params:{...t,...s}});return{data:a,count:100}}async getQualityProfilesByLanguage(t){const{data:s}=await this.client.get("/qualityprofiles",{params:{language_id:t}});return s}async getAllLanguages(){const{data:t}=await this.client.get("/languages");return t}};let Y=R;_(Y,"instance");const Ot=Y.getInstance,C=class{constructor(t){this.client=t}async getCSVReportUpdatables(t){return await this.client.rpc("get_changed_q",{quality_id:Number(t)}).select("*").csv().throwOnError()}async getCSVCompletFiltered(t){return await this.prepareFilteredQuery(t).csv().throwOnError()}async downloadReport(t,s=!0){const{data:a}=s?await this.getCSVReportUpdatables(Number(t.qualityProfile_id)):await this.getCSVCompletFiltered(t),o=document.createElement("a");o.download="report";const r=URL.createObjectURL(new Blob([a],{type:"text/csv"}));o.href=r,o.click(),URL.revokeObjectURL(r),o.remove()}changeIsActive(t,s=!0){if(t.length)return this.client.from("status").update({isActive:s,updated_at:new Date}).in("id",t.map(({id:a})=>a)).throwOnError()}async postNewStatus(t){const s=t.filter(({newStatus:o})=>!o),a=t.filter(({newStatus:o})=>o);await Promise.all([this.changeIsActive(s,!1),this.changeIsActive(a,!0)])}async getTotalCountByTable(t){const{count:s}=await this.client.from(t).select("*",{count:"exact",head:!0}).throwOnError();return s??0}async getQualityProfilesByLanguage(t){const{data:s}=await this.client.from("qualityprofiles").select().eq("language_id",t).throwOnError();return s}buildQuery(t,s){for(const a in s){if(!Object.prototype.hasOwnProperty.call(s,a))continue;const o=s[a];o!=="all"&&o!=null&&(t=t.eq(C.queryBuilderColumns[a],o))}return t}prepareFilteredQuery(t){delete t.lang_id;const s=this.client.from("status").select(`
        *,
        qualityprofiles(
          *
        ),
        rules!inner(
          *
        )
      `,{count:"exact"});return this.buildQuery(s,t)}async getPaginatedRulesByFilter(t,s){const a=this.prepareFilteredQuery(t),{data:o,count:r}=await a.range(...this.getRange(s)).order("id",{ascending:!0}).throwOnError();return{data:o,count:r}}async getAllLanguages(){const{data:t}=await this.client.from("languages").select().throwOnError();return t.filter(({name:s})=>C.whiteList[s])}static getInstance(){return C.instance??(C.instance=new C(He(ve,Ce))),C.instance}getRange({page:t,limit:s=10}){return[(t-1)*s,t*s-1]}};let P=C;_(P,"instance"),_(P,"whiteList",{ts:!0,js:!0,css:!0,java:!0,web:!0}),_(P,"queryBuilderColumns",{severity:"rules.severity",type:"rules.type",isActiveSonar:"isActiveSonar",qualityProfile_id:"qualityProfile_id"});const Dt=P.getInstance,Bt={axios:Ot,supabase:Dt},E=Bt[Ft](),qt=()=>{const n=me(),t=l.useRef(null),{data:s,isFetching:a}=X({queryKey:["qualityprofile",n],queryFn:()=>E.getQualityProfilesByLanguage(n),enabled:!!n});l.useEffect(()=>{var r;re(((r=t.current)==null?void 0:r.value)??"")},[n]);const o=l.useCallback(r=>{re(r.target.value)},[]);return a?e.jsx(ee,{}):e.jsxs(le,{className:"mainFilters",sx:{width:200},children:[e.jsx(ce,{id:"qualityprofile",children:"Quality Profile"}),e.jsx(ue,{ref:t,onChange:o,label:"Quality Profile",labelId:"qualityprofile",defaultValue:"",displayEmpty:!0,children:s==null?void 0:s.map(({id:r,name:i})=>e.jsx(T,{value:r,children:i},r))})]})},Nt=()=>{const{setIsOpen:n,isOpen:t}=ht(),{data:s,isLoading:a}=X({queryKey:["languages"],queryFn:()=>E.getAllLanguages()}),o=l.useCallback(r=>{bt(r.target.value)},[]);return l.useEffect(()=>{localStorage.getItem("firstVisit")||(localStorage.setItem("firstVisit",new Date().toDateString()),n(!0))},[n]),l.useEffect(()=>{const r=document.querySelector("body");t?r.style.overflow="hidden":r.style.overflow="auto"},[t]),e.jsx(le,{sx:{width:200},className:"language",children:a?e.jsx(ee,{}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{id:"language",children:"Lenguaje"}),e.jsx(ue,{labelId:"language",label:"Lenguaje",onChange:o,sx:{width:200},defaultValue:"",displayEmpty:!0,children:s==null?void 0:s.map(({id:r,name:i})=>e.jsx(T,{value:r,children:i},r))})]})})};var L=(n=>(n.DARK="dark",n.LIGTH="light",n))(L||{});const we={fontFamily:["Foco"].join(",")},zt=ie({palette:{mode:"dark"},typography:{...we}}),Qt=ie({palette:{mode:"light",primary:{main:"#0099CC"},secondary:{main:"#EE2C70"}},typography:{...we}}),Se=l.createContext({toggleColorMode(){}}),Yt=({app:n})=>{const t=Je("(prefers-color-scheme: dark)"),[s,a]=l.useState(localStorage.getItem("mode")||(t?"light":"dark")),o=l.useMemo(()=>({toggleColorMode(){a(r=>r==="dark"?"light":"dark")}}),[]);return l.useEffect(()=>{localStorage.setItem("mode",s)},[s]),e.jsx(Se.Provider,{value:o,children:e.jsxs(We,{theme:s==="dark"?zt:Qt,children:[e.jsx(Ze,{}),n]})})},$t=l.memo(function({body:t,header:s,footer:a,stickyHeader:o=!0}){return e.jsxs(Xe,{sx:{paddingY:4,background:"transparent"},children:[e.jsx(et,{sx:{maxHeight:"80vh"},children:e.jsxs(tt,{stickyHeader:o,children:[e.jsx(nt,{children:s}),e.jsx(st,{sx:{backgroundColor:({palette:r})=>r.mode===L.DARK?r.grey[800]:r.grey[300]},children:t}),a&&t&&e.jsx(at,{children:a})]})}),!t&&e.jsx("div",{children:"asdsadsadsda"})]})}),Vt=({value:n,label:t,reactiveCb:s})=>{const a=l.useCallback(()=>{s(n)},[s,n]);return e.jsx(T,{onClick:a,children:t})},se=({filterConfig:n,reactiveCallback:t,isClosingRecursive:s})=>{const[a,o]=l.useState(null),[r,i]=l.useState(!0),d=l.useCallback(u=>{t(u),i(u==="all"),s&&o(null)},[s,t]),g=l.useCallback(()=>{o(null)},[]),c=l.useCallback(u=>{u.preventDefault(),o(u.currentTarget)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(V,{onClick:c,sx:{padding:"1px !important"},children:e.jsx(rt,{variant:"dot",invisible:r,color:"secondary",children:e.jsx(Ie,{sx:{color:"white"}})})}),e.jsx(te,{anchorEl:a,onClose:g,open:!!a,children:n.map(({value:u,label:h})=>e.jsx(Vt,{label:h,value:u,reactiveCb:d}))})]})},Ut=Object.freeze({all:null,active:!0,deactive:!1}),Ht=[{value:"all",label:"Todos"},{value:"active",label:"Activo"},{value:"deactive",label:"Inactivo"}],Gt=()=>{const n=l.useCallback(t=>{St(Ut[t])},[]);return e.jsx(se,{filterConfig:Ht,isClosingRecursive:!0,reactiveCallback:n})};var _e=(n=>(n.Blocker="BLOCKER",n.Critical="CRITICAL",n.Info="INFO",n.Major="MAJOR",n.Minor="MINOR",n))(_e||{}),Re=(n=>(n.Bug="BUG",n.CodeSmell="CODE_SMELL",n.SecurityHotspot="SECURITY_HOTSPOT",n.Vulnerability="VULNERABILITY",n))(Re||{});const Kt=[{value:"all",label:"Todos"},...Object.values(_e).map(n=>({value:n,label:n}))],Jt=()=>{const n=l.useCallback(t=>{Rt(t)},[]);return e.jsx(se,{filterConfig:Kt,isClosingRecursive:!0,reactiveCallback:n})},Wt=[{value:"all",label:"Todos"},...Object.values(Re).map(n=>({value:n,label:n}))],Zt=()=>{const n=l.useCallback(t=>vt(t),[]);return e.jsx(se,{filterConfig:Wt,isClosingRecursive:!0,reactiveCallback:n})},Q=[{label:"Código",resource:"key",textAlign:"left"},{label:"Regla",resource:"name",textAlign:"left"},{label:"Tipo",resource:"type",filter:e.jsx(Zt,{})},{label:"Severidad",resource:"severity",filter:e.jsx(Jt,{})},{label:"Detalle",especialConfig:!0,resource:"htmlDesc"},{label:"Estado Actual",resource:"isActiveSonar",especialConfig:!0,className:"actualState",filter:e.jsx(Gt,{})},{label:"Estado Propuesto",resource:"isActive",especialConfig:!0,className:"proposedState"},{label:"Última Propuesta: ",resource:"updated_at",especialConfig:!0,icon:e.jsx(Pe,{sx:{color:n=>n.palette.common.white}})}],M=class extends pt{constructor(){super("syncro");_(this,"rulesStatus");this.version(1).stores({rulesStatus:"id, updated_at, newStatus"})}static getInstance(){return M.instace??(M.instace=new M),M.instace}async getLocalRules(s){return await this.rulesStatus.where("id").anyOf(s).toArray()}async countAllRules(){return await this.rulesStatus.count()}};let $=M;_($,"instace");const N=$.getInstance(),Me=new Ge({defaultOptions:{queries:{staleTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1,_optimisticResults:"optimistic"}}}),Xt=()=>{const n=ye(),t=me(),s=xe(),a=je(),o=fe(),r=Pt(),[i,d]=l.useState(10),g=l.useRef(0),[c,u]=l.useState([]),h=!!(t&&a),{data:x,isFetching:z}=X({queryKey:["rules",t,a,o,s,n,r,i],async queryFn(){const{data:j,count:S}=await E.getPaginatedRulesByFilter({severity:n,lang_id:t,isActiveSonar:s,qualityProfile_id:a,type:o},{page:r,limit:i});return g.current=S,kt(S),j},enabled:h,keepPreviousData:!0});l.useEffect(()=>{K(1)},[o,n,s,a]);const k=l.useCallback(async()=>{if(!h)return;const j=x==null?void 0:x.map(({rules:f,...b})=>({...f,...b})),O=(await N.getLocalRules(j.map(({id:f})=>Number(f)))).reduce((f,{id:b,newStatus:y})=>(f[b]=y,f),{}),D=j.map(f=>({...f,isActive:O[f.id]??f.isActive}));u(D)},[x,h]);return l.useEffect(()=>{k()},[x,r,k]),[K,d,{data:c,isLoading:z,total:g.current,page:r,rowsPerPage:i}]},en=()=>{const[n,t]=l.useState(!1);return[l.useCallback(async()=>{t(!0);const a=await N.rulesStatus.toArray();await E.postNewStatus(a),await N.rulesStatus.clear(),await Me.invalidateQueries({queryKey:["rules"]}),K(1),t(!1)},[]),n]},tn=l.memo(({data:n})=>e.jsx(ne,{children:n.map(({label:t,icon:s,className:a,filter:o})=>e.jsx(q,{variant:"head",className:a,sx:{background:r=>`${r.palette.grey[900]} !important`},children:e.jsxs(p,{direction:"row",gap:.5,alignItems:"center",justifyContent:"center",children:[s,e.jsx(m,{sx:{color:r=>r.palette.common.white},fontWeight:700,children:t}),o]})},t))}));var J={},nn={get exports(){return J},set exports(n){J=n}};(function(n,t){(function(s,a){n.exports=a()})(Z,function(){return function(s,a,o){o.updateLocale=function(r,i){var d=o.Ls[r];if(d)return(i?Object.keys(i):[]).forEach(function(g){d[g]=i[g]}),d}}})})(nn);const sn=J;var W={},an={get exports(){return W},set exports(n){W=n}};(function(n,t){(function(s,a){n.exports=a()})(Z,function(){return function(s,a,o){s=s||{};var r=a.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function d(c,u,h,x){return r.fromToBase(c,u,h,x)}o.en.relativeTime=i,r.fromToBase=function(c,u,h,x,z){for(var k,j,S,O=h.$locale().relativeTime||i,D=s.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],f=D.length,b=0;b<f;b+=1){var y=D[b];y.d&&(k=x?o(c).diff(h,y.d,!0):h.diff(c,y.d,!0));var I=(s.rounding||Math.round)(Math.abs(k));if(S=k>0,I<=y.r||!y.r){I<=1&&b>0&&(y=D[b-1]);var U=O[y.l];z&&(I=z(""+I)),j=typeof U=="string"?U.replace("%d",I):U(I,u,y.l,S);break}}if(u)return j;var H=S?O.future:O.past;return typeof H=="function"?H(j):H.replace("%s",j)},r.to=function(c,u){return d(c,u,this,!0)},r.from=function(c,u){return d(c,u,this)};var g=function(c){return c.$u?o.utc():o()};r.toNow=function(c){return this.to(g(this),c)},r.fromNow=function(c){return this.from(g(this),c)}}})})(an);const rn=W;var oe={},on={get exports(){return oe},set exports(n){oe=n}};(function(n,t){(function(s,a){n.exports=a(mt)})(Z,function(s){function a(i){return i&&typeof i=="object"&&"default"in i?i:{default:i}}var o=a(s),r={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(i){return i+"º"}};return o.default.locale(r,null,!0),r})})(on);F.extend(sn);F.locale("es");F.extend(rn);F.updateLocale("es",{relativeTime:{future:"en %s",past:"hace %s",s:"1 s",m:"1 min",mm:"%d min",h:"1 h",hh:"%d h",d:"1 d",dd:"%d d",M:"1 M",MM:"%d M",y:"1 Y",yy:"%d Y"}});const ln=({date:n})=>e.jsx(m,{align:"left",children:F(n).from(new Date)});function cn(n){const{tags:t,isActive:s,dateSonar:a,ruleTitle:o,ruleDescription:r}=n;return e.jsxs(A,{children:[e.jsxs(p,{padding:2,direction:"column",spacing:2,children:[e.jsxs(p,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:[e.jsx(B,{sx:{backgroundColor:({palette:i})=>i.mode===L.DARK?i.grey[900]:i.grey[800],color:"white"},label:`Regla ${s?"activo":"inactivo"} desde:`}),e.jsx(B,{label:`${a??"Sin info"}`})]}),e.jsx(p,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:t.map(i=>e.jsx(B,{label:i},i))})]}),e.jsx(p,{direction:"row",justifyContent:"flex-start",alignItems:"center",padding:2,pb:0,children:e.jsx(ot,{title:o,children:e.jsx(B,{color:"secondary",label:e.jsx(m,{noWrap:!0,variant:"h5",children:o})})})}),e.jsxs(p,{direction:"column",justifyContent:"center",padding:2,children:[e.jsx(p,{direction:"row",justifyContent:"flex-start",children:e.jsx(B,{label:"Descripción de la Regla",sx:{backgroundColor:({palette:i})=>i.mode===L.DARK?i.grey[900]:i.grey[800],color:"white"}})}),e.jsx(m,{dangerouslySetInnerHTML:{__html:r}})]})]})}const un={width:"80vh",maxWidth:600,minWidth:400,height:"80vh",minHeight:400,borderRadius:50},dn=l.memo(function({popoverBody:n,icon:t,sxProps:s}){const[a,o]=l.useState(null),r=l.useCallback(d=>{o(d.currentTarget)},[]),i=l.useCallback(()=>{o(null)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(V,{onClick:r,sx:{margin:"auto"},children:t}),e.jsxs(it,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:s??un,open:!!a,onClose:i,anchorEl:a,children:[e.jsx(V,{onClick:i,sx:{position:"absolute",top:0,right:0},children:e.jsx(Ee,{sx:{fontSize:"medium"}})}),e.jsx(A,{margin:1,children:n})]})]})});function hn({initialStatus:n,id:t}){const s=l.useCallback(a=>N.rulesStatus.put({id:Number(t),newStatus:a.target.checked,updated_at:new Date}),[t]);return e.jsx(de,{onChange:s,defaultChecked:n})}const gn=({resource:n,value:t,result:s,secondaryValue:a})=>n==="isActiveSonar"?e.jsx(m,{children:t?"Activo":"Inactivo"}):n==="htmlDesc"?e.jsx(dn,{icon:e.jsx(Le,{}),popoverBody:e.jsx(cn,{tags:[s.severity,s.type],isActive:s.isActive,ruleTitle:s.name,ruleDescription:s.htmlDesc})}):n==="updated_at"?Math.abs(F(String(t)).diff(a,"hours"))>6?e.jsx(ln,{date:String(t)}):e.jsx(m,{align:"left",children:"--"}):e.jsx(hn,{initialStatus:!!t,id:s.id}),pn=({colSpan:n})=>e.jsx(q,{colSpan:n,children:e.jsx(A,{display:"grid",sx:{placeContent:"center",minHeight:400},children:e.jsx(ee,{})})}),mn=({icon:n,primaryText:t,secondaryText:s})=>e.jsxs(p,{direction:"column",justifyContent:"center",alignItems:"center",minHeight:"50vh",sx:{fontSize:100},gap:8,children:[n,e.jsxs(p,{direction:"column",gap:4,children:[e.jsx(m,{color:"GrayText",variant:"h3",children:t}),s&&e.jsx(m,{textAlign:"center",color:"GrayText",variant:"body1",children:s})]})]}),fn=({hasContent:n,children:t,colSpan:s})=>n?e.jsx(e.Fragment,{children:t}):e.jsx(ne,{children:e.jsx(q,{colSpan:s,children:e.jsx(mn,{icon:e.jsx(Ae,{color:"disabled",fontSize:"inherit"}),primaryText:"Sin datos",secondaryText:"Selecciona filtros"})})});function xn(){const[n,t,{data:s,isLoading:a,total:o,page:r,rowsPerPage:i}]=Xt(),d=l.useCallback((c,u)=>{c&&n(u+1)},[n]),g=l.useCallback(c=>{t(parseInt(c.target.value,10)),n(1)},[n,t]);return e.jsxs(e.Fragment,{children:[e.jsx($t,{body:a?e.jsx(pn,{colSpan:Q.length}):e.jsx(fn,{hasContent:!!(s!=null&&s.length),colSpan:Q.length,children:s==null?void 0:s.map(c=>e.jsx(ne,{children:Q.map(({resource:u,especialConfig:h,textAlign:x})=>h?e.jsx(q,{sx:{textAlign:"center"},children:e.jsx(gn,{result:c,resource:u,secondaryValue:c.created_at,value:c[u]??"--"})},u+c.id):e.jsx(q,{sx:{textAlign:x??"center"},children:String(c[u]??"--")},u+c.id))},c.id))}),header:e.jsx(tn,{data:Q})}),e.jsx(A,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(lt,{rowsPerPage:i,count:o??1e3,page:r-1,onPageChange:d,onRowsPerPageChange:g,labelRowsPerPage:"Filas por pagina"})})]})}const yn=()=>{const n=ft.useLiveQuery(()=>N.rulesStatus.count());return e.jsxs(p,{direction:"row",spacing:1,p:1,borderRadius:2,bgcolor:({palette:{mode:t,grey:s}})=>t!==L.DARK?"rgba(65, 255, 200, 0.4)":s[700],children:[n?e.jsx(Fe,{color:"warning"}):e.jsx(Oe,{color:"success"}),e.jsx(m,{children:n?"Tienes cambios sin sincronizar":"No hay cambios sin sincronizar"})]})},jn=()=>{const{palette:n}=ct(),t=l.useContext(Se),s=l.useCallback(()=>{t.toggleColorMode()},[t]);return e.jsx(ut,{sx:{background:({palette:a})=>`linear-gradient(90deg, ${a.primary.main} 80%, ${a.secondary.main} 100%)`},children:e.jsx(he,{children:e.jsxs(dt,{disableGutters:!0,sx:{justifyContent:"space-between"},children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(m,{variant:"h6",fontWeight:900,children:"Sonardash"}),e.jsx(m,{variant:"body1",children:"/ Gestión de Reglas"}),e.jsx("img",{src:"https://www.pacifico.com.pe/image/layout_set_logo?img_id=26556784&t=1682438787127",alt:"logo de pacifico seguros"})]}),e.jsx(yn,{}),e.jsxs(p,{direction:"row",justifyContent:"center",alignItems:"center",children:[(n==null?void 0:n.mode)===L.DARK?e.jsx(De,{}):e.jsx(Be,{}),e.jsx(de,{color:"warning",onChange:s})]})]})})})},bn=({cb:n})=>{const t=ye(),s=xe(),a=je(),o=fe(),[r,i]=l.useState(null),d=l.useCallback(()=>{i(null)},[]),g=l.useCallback(async({currentTarget:h})=>{a&&i(h)},[a]),c=l.useCallback(async()=>{n&&await n(),await E.downloadReport({qualityProfile_id:a})},[n,a]),u=l.useCallback(async()=>{n&&await n(),await E.downloadReport({isActiveSonar:s,qualityProfile_id:a,severity:t,type:o},!1)},[s,a,t,o,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(T,{disabled:!a,onClick:g,children:[e.jsx(ge,{children:e.jsx(qe,{})}),e.jsx(pe,{children:"Descarga Personalizada"})]}),e.jsxs(te,{anchorEl:r,onClose:d,open:!!r,children:[e.jsx(T,{onClick:c,children:"Reporte de Actualizables"}),e.jsx(T,{onClick:u,children:"Reporte Completo"})]})]})},Cn=()=>{const[n,t]=l.useState(null),s=l.useRef(null),a=At(),[o]=en(),r=l.useCallback(()=>{t(null)},[]);l.useEffect(()=>{t(a?s.current:null)},[a]);const i=l.useCallback(({currentTarget:d})=>{t(d)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(xt,{children:e.jsx(V,{ref:s,onClick:i,sx:{background:({palette:d})=>d.secondary.main,zIndex:500},className:"dragableMenu",children:e.jsx(Ne,{fontSize:"large"})})}),e.jsxs(te,{className:"menuDragable",anchorEl:n,open:!!n,onClose:r,children:[e.jsxs(T,{onClick:o,children:[e.jsx(ge,{children:e.jsx(ze,{fontSize:"small"})}),e.jsx(pe,{children:"Sincronizar"})]}),e.jsx(bn,{cb:o})]})]})},vn=({content:n})=>e.jsx("div",{style:{position:"sticky",bottom:20,left:20,display:"flex",justifyContent:"flex-end",zIndex:500},children:n});function wn(){return e.jsx(Yt,{app:e.jsxs(e.Fragment,{children:[e.jsx(jn,{}),e.jsxs(he,{sx:{paddingTop:12},children:[e.jsxs(p,{gap:3,children:[e.jsxs(m,{children:[e.jsx(Qe,{})," Activa o desactiva los switches dependiendo si deseas habilitar la regla o no"]}),e.jsxs(m,{children:[e.jsx(Ye,{})," Recuerda que los estados que propongas no se aplicarán de inmediato en SonarQube"]})]}),e.jsx(p,{direction:"column",gap:4,marginTop:4,children:e.jsxs(A,{display:"flex",gap:4,children:[e.jsx(Nt,{}),e.jsx(qt,{})]})}),e.jsx(xn,{}),e.jsx(vn,{content:e.jsx(Cn,{})}),e.jsx(p,{paddingY:3,direction:"row",gap:3,justifyContent:"space-between"})]})]})})}const Sn="pacifico.dev.com";yt("ctrl+m",n=>{n.preventDefault(),Lt(!0)});window.woopra.config({domain:Sn,outgoing_tracking:!0,download_tracking:!0,click_tracking:!0}),window.woopra.track();G.createRoot(document.getElementById("root")).render(e.jsx(Ve.StrictMode,{children:e.jsx(gt,{steps:[{selector:".language",content:"Selecciona el lenguaje de programación del cual deseas consultar reglas."},{selector:".mainFilters",content:"Ahora procede a seleccionar el perfil a consultar"},{selector:".actualState",content:"Este es el estado actual de la regla en Sonarqube. Las reglas activas son las que analizan los repositorios."},{selector:".proposedState",content:"Aquí podrás proponer si una regla debe estar activada o desactivada, recuerda que tu propuesta no se verá reflejada en SonarQube inmediatamente."},{selector:".dragableMenu",content:e.jsxs(m,{children:["Las opciones de descarga y guardado se encuentran en este botón. Si no lo encuentras rápido, ubícalo con ",e.jsx("kbd",{children:"ctrl"})," +"," ",e.jsx("kbd",{children:"m"}),", ¡también lo puedes mover por toda la pantalla!"]})}],children:e.jsx(Ke,{client:Me,children:e.jsx(wn,{})})})}));
