var Me=Object.defineProperty;var De=(n,e,s)=>e in n?Me(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var p=(n,e,s)=>(De(n,typeof e!="symbol"?e+"":e,s),s);import{F as xe,j as t,a3 as Be,a4 as de,a5 as Ne,a6 as Ue,a7 as qe,a8 as Ve,a9 as Qe,aa as ze,ab as $e,ac as He}from"./@mui/icons-material-c2086071.js";import{a as Ge,r as o,b as Ke}from"./vendor-b612640b.js";import{c as re,_ as We}from"./@supabase/supabase-js-711ba96a.js";import{u as je,C as Je,P as Ze,B as V,T as Ye,a as Xe,b as et,c as tt,d as st,M as we,L as be,e as Ce,D as nt,f as at,g as rt,h as he,i as $,j as ge,k as it,l as ot,m as ct,S as k,n as lt,A as ut,o as ie,p as dt,q as ht,r as gt,s as mt,t as pt,F as A,I as E,O as F,v as ft,w as ee}from"./@mui/material-99b79a59.js";import{w as yt,s as te,x as L,P as xt,b,C as jt,u as Se,y as wt,z as bt,S as Ct}from"./@mui/lab-cc97fd70.js";import{$ as St}from"./dexie-3976de5d.js";import{d as vt}from"./dexie-react-hooks-0c2ddb12.js";import{a as kt}from"./axios-760d4776.js";import{c as C}from"./@react-rxjs/utils-24ca515a.js";import{b as S}from"./@react-rxjs/core-1a0bb4f0.js";import{Q as It,u as ve,a as Tt}from"./@tanstack/react-query-7cfe65c4.js";import{u as ke}from"./react-hook-form-c6612ec3.js";import{u as Pt,S as Rt}from"./notistack-f220509a.js";import{T as Ot}from"./@reactour/tour-e24be7d6.js";import{h as At}from"./hotkeys-js-d20e5801.js";import"./@emotion/react-0d101b94.js";import"./@emotion/styled-6b07d811.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var se={},me=Ge;se.createRoot=me.createRoot,se.hydrateRoot=me.hydrateRoot;var oe=(n=>(n.DARK="dark",n.LIGTH="light",n))(oe||{});const Ie={fontFamily:["Foco"].join(",")},Et=xe({palette:{mode:"dark"},typography:{...Ie}}),Ft=xe({palette:{mode:"light",primary:{main:"#0099CC"},secondary:{main:"#EE2C70"}},typography:{...Ie}}),Te=o.createContext({toggleColorMode(){}}),Lt=({app:n})=>{const e=je("(prefers-color-scheme: dark)"),[s,r]=o.useState(localStorage.getItem("mode")||(e?"light":"dark")),a=o.useMemo(()=>({toggleColorMode(){r(i=>i==="dark"?"light":"dark")}}),[]);return o.useEffect(()=>{localStorage.setItem("mode",s)},[s]),t.jsx(Te.Provider,{value:a,children:t.jsxs(yt,{theme:s==="dark"?Et:Ft,children:[t.jsx(Je,{}),n]})})},T=class extends St{constructor(){super("syncro");p(this,"rulesStatus");this.version(5).stores({rulesStatus:"id, updated_at, newStatus, language, qualityProfileId, description, user_email"})}static getInstance(){return T.instance??(T.instance=new T),T.instance}async getLocalRules(s){return await this.rulesStatus.where("id").anyOf(s).toArray()}async countAllRules(){return await this.rulesStatus.count()}async saveDescription(s,r){const a=await this.rulesStatus.get(s.id);return await this.rulesStatus.put({id:Number(s.id),languageId:s.lang_id,newStatus:s.isActive,qualityProfileId:Number(s.qualityProfile_id),...a,updated_at:new Date,...r?{description:r}:{},user_email:s.user_email})}async getRulesToUpdate(){return await this.rulesStatus.toArray()}};let H=T;p(H,"instance");const _=H.getInstance(),_t={width:"80vh",maxWidth:600,minWidth:400,height:"80vh",minHeight:400,borderRadius:50},Mt=o.memo(function({popoverBody:n,icon:e,sxProps:s,textButton:r,buttonProps:a}){const[i,c]=o.useState(null),l=o.useCallback(d=>{d.stopPropagation(),c(d.currentTarget)},[]),u=o.useCallback(d=>{d.stopPropagation(),c(null)},[]);return t.jsxs(t.Fragment,{children:[r?t.jsx(L,{startIcon:e,onClick:l,...a,children:r}):t.jsx(te,{onClick:l,sx:{margin:"auto"},children:e}),t.jsxs(Ze,{anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:s??_t,open:!!i,onClose:u,anchorEl:i,children:[t.jsx(te,{onClick:u,sx:{position:"absolute",top:0,right:0},children:t.jsx(Be,{sx:{fontSize:"medium"}})}),t.jsx(V,{margin:1,children:n})]})]})});var U=(n=>(n.FIRST_VISIT="firstVisit",n.TIMES_VISIT="timesVisit",n))(U||{});const Pe=n=>{const e={VITE_SUPABASE_TOKEN:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZueGZtZnNmdGR3aGlhaGxnb3pnIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODE5NTQ2MjIsImV4cCI6MTk5NzUzMDYyMn0.2-lbg4bjMgp6MxaHUpHd1qTIHoydHr0uXAi78MZ06h4",VITE_WOOPRA_DOMAIN:"pacifico.dev.com",VITE_SUPABASE_URL:"https://fnxfmfsftdwhiahlgozg.supabase.co",VITE_TYPE_CLIENT:"supabase",BASE_URL:"/rulesAdmin",MODE:"production",DEV:!1,PROD:!0,SSR:!1}[n];if(!e)throw new Error(`Not found env ${n}`);return e},Ks=(n,e=!0,s=document.body)=>{const r=s.querySelector(n);r&&(r.style.overflow=e?"hidden":"auto")},Dt=(n,e)=>{const s=new Date;return s.setHours(23),n>s&&e<=3},Ws=()=>{const n=localStorage.getItem(U.FIRST_VISIT),e=localStorage.getItem(U.TIMES_VISIT);if(!(n||!Dt(new Date(n),Number(e))))return localStorage.setItem(U.FIRST_VISIT,new Date().toDateString()),localStorage.setItem(U.TIMES_VISIT,((Number(e)||0)+1).toString()),!0},pe=n=>n!=null,Bt={css:1,java:1,web:1,Web:1,javascript:1,typescript:1},Nt=(n,e=Bt)=>{const[s]=n.match(/^.+:/);return e[s.substring(0,s.length-1)]?n.replace(s,""):n},Js=(n,e,s)=>e?Nt(n,s):n,ne=(n,e,s)=>n?e:s,ce=(n,e,s)=>n==null?void 0:n.reduce((r,a)=>(r[String(a[e])]=s?a[s]:a,r),{}),Ut=()=>{const n=new Date;return n.setUTCHours(0),n.setUTCMinutes(0),n},Re=(n,e,s=!0)=>{if(!s)return window[n]=e};Re("keyBy",ce);Re("renderConditional",ne);const Z=Pe("VITE_SUPABASE_TOKEN"),Y=Pe("VITE_SUPABASE_URL"),qt="supabase",P=class{constructor(e){this.client=e}getConflicts(e){throw new Error("Method not implemented.")}getByRuleName(e,s,r){throw new Error("Method not implemented.")}downloadReport(e){throw new Error("Method not implemented.")}postNewStatus(e){throw new Error("Method not implemented.")}async getTotalCountByTable(e){return 100}static getInstance(){return P.instance??(P.instance=new P(kt.create({baseURL:Y,headers:{apiKey:Z}}))),P.instance}async getPaginatedRulesByFilter(e,s){const{data:r}=await this.client.get("/rules",{params:{...e,...s}});return{data:r,count:100}}async getQualityProfilesByLanguage(e){const{data:s}=await this.client.get("/qualityprofiles",{params:{language_id:e}});return s}async getAllLanguages(){const{data:e}=await this.client.get("/languages");return e}};let G=P;p(G,"instance");const Vt=G.getInstance,w=class{constructor(e){this.client=e}async getConflicts(e){const s=Ut().toISOString(),{data:r}=await this.client.from("status").select(`
          *,
          qualityprofiles(
          *
          ),
          rules!inner(
            *
        )
        `).in("id",e.map(({id:c})=>c)).gt("updated_at",s).throwOnError(),a=ce(r,"id");return e.filter(({id:c,newStatus:l})=>{var u,d;return pe((u=a[c])==null?void 0:u.isActive)&&((d=a[c])==null?void 0:d.isActive)!==l}).map(c=>{const{rules:l,...u}=a[c.id];return{...l,...u,...c}})}async getCSVReportUpdatables(e){return await this.client.rpc("get_changed_q",{quality_id:Number(e)}).select("*").csv().throwOnError()}async getCSVCompletFiltered(e){return await this.prepareFilteredQuery(e).csv().throwOnError()}async downloadReport(e,s=!0){const{data:r}=s?await this.getCSVReportUpdatables(Number(e.qualityProfile_id)):await this.getCSVCompletFiltered(e),a=document.createElement("a");a.download="report";const i=URL.createObjectURL(new Blob([r],{type:"text/csv"}));a.href=i,a.click(),URL.revokeObjectURL(i),a.remove()}changeIsActive(e,s=!0){if(!e.length)return;const[{user_email:r}]=e;return this.client.from("status").update({isActive:s,updated_at:new Date,user_email:r}).in("id",e.map(({id:a})=>a)).throwOnError()}async bulkUpdateDescription(e){if(!e.length)return;const{data:s}=await this.client.auth.getUser();return await this.client.from("status").upsert(e.map(({id:r,description:a,qualityProfileId:i})=>{var c;return{id:r,description:a,qualityProfile_id:i,user_email:(c=s.user)==null?void 0:c.email}})).select().throwOnError()}async postNewStatus(e){const s=e.filter(({newStatus:i})=>!i),r=e.filter(({newStatus:i})=>i),a=e.filter(({description:i})=>!!i);await Promise.all([this.changeIsActive(s,!1),this.changeIsActive(r,!0),this.bulkUpdateDescription(a)])}async getTotalCountByTable(e){const{count:s}=await this.client.from(e).select("*",{count:"exact",head:!0}).throwOnError();return s??0}async getQualityProfilesByLanguage(e){const{data:s}=await this.client.from("qualityprofiles").select().eq("language_id",e).throwOnError();return s}buildQuery(e,s){for(const r in s){if(!Object.prototype.hasOwnProperty.call(s,r))continue;const a=s[r];a!=="all"&&pe(a)&&(e=e.eq(w.queryBuilderColumns[r],a))}return e}prepareFilteredQuery(e){delete e.lang_id;const s=this.client.from("status").select(`
        *,
        qualityprofiles(
          *
        ),
        rules!inner(
          *
        )
      `,{count:"exact"});return this.buildQuery(s,e)}async getPaginatedRulesByFilter(e,s){const r=this.prepareFilteredQuery(e),{data:a,count:i}=await r.range(...this.getRange(s)).order("id",{ascending:!0}).throwOnError();return{data:a,count:i}}async getAllLanguages(){const{data:e}=await this.client.from("languages").select().throwOnError();return e.filter(({name:s})=>w.whiteList[s])}static getInstance(e){return w.instance??(w.instance=new w(e??re(Y,Z))),w.instance}getRange({page:e,limit:s=10}){return[(e-1)*s,e*s-1]}async getByRuleName(e,s,r){const{data:a,count:i}=await this.prepareFilteredQuery(s).ilike("rules.name",`%${e}%`).range(...this.getRange(r)).order("id",{ascending:!0}).throwOnError();return{data:a,count:i}}subscribeChanges(e){return this.client.channel("changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"status"},e).subscribe()}};let O=w;p(O,"instance"),p(O,"whiteList",{ts:!0,js:!0,css:!0,java:!0,web:!0}),p(O,"queryBuilderColumns",{severity:"rules.severity",type:"rules.type",isActiveSonar:"isActiveSonar",qualityProfile_id:"qualityProfile_id"});const Oe=O.getInstance,Ae=re(Y,Z),Qt={axios:Vt,supabase:()=>Oe(Ae)},q=Qt[qt](),[zt,Zs]=C(),[$t]=S(zt,""),[Ht,Ys]=C(),[Gt]=S(Ht,"all"),[Kt,Xs]=C(),[Wt]=S(Kt,null),[Jt,en]=C(),[Zt]=S(Jt,"all"),[Yt,tn]=C(),[Xt]=S(Yt,""),[es,ts]=C();S(es,0);const[ss,J]=C(),[ns]=S(ss,1),[as,rs]=C(),[sn]=S(as,!1),[is,nn]=C(),[os]=S(is,null),le=new It({defaultOptions:{queries:{staleTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1,_optimisticResults:"optimistic"}}}),v=class{constructor(){if(v.instance)throw new Error("Singleton")}static getInstance(){return v.instance??(v.instance=new v),v.instance}get tokenData(){return{token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken")}}set tokenData(e){Object.keys(e).forEach(s=>localStorage.setItem(s,e[s]))}clean(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}};let K=v;p(K,"instance");const R=class{constructor(e,s=K.getInstance()){p(this,"isLogged");p(this,"user");this.client=e,this.authStorage=s}async singUp({email:e,firstName:s,lastName:r,password:a,username:i}){const{data:c,error:l}=await this.client.signUp({email:e,password:a,options:{data:{first_name:s,last_name:r,username:i}}});if(l)throw l;return c}static getInstance(e){return R.instance??(R.instance=new R(e??re(Y,Z).auth)),R.instance}setToken(e){this.authStorage.tokenData={refreshToken:e.refresh_token,token:e.access_token}}async login(e,s){const{data:r,error:a}=await this.client.signInWithPassword({email:e,password:s});if(a)throw a;return this.setToken(r.session),this.isLogged=!0,this.user=r.user,r}async verifyAuth(e){const{data:s,error:r}=await this.client.getUser(e);if(r)throw r;return s}async logOut(e){const{error:s}=await this.client.signOut();if(s)throw s;return this.user=null,this.authStorage.clean(),e}async getPermissions(){const{data:e,error:s}=await this.client.mfa.getAuthenticatorAssuranceLevel();if(s)throw s;return e}async checkAuth(e,s){const r=e??this.authStorage.tokenData.token,a=s??this.authStorage.tokenData.refreshToken;if(!r||!a)return;const{data:i,error:c}=await this.client.setSession({access_token:r,refresh_token:a});if(c)throw c;return this.setToken(i.session),this.isLogged=!0,this.user=i.user,i}};let W=R;p(W,"instance");const I=Object.assign(W.getInstance(Ae.auth),{isLoading:!0}),M=o.createContext(I),cs=()=>{const n=Zt(),e=$t(),s=Wt(),r=Xt(),a=Gt(),i=ns(),c=os();return{severity:n,lang_id:e,isActiveSonar:s,qualityProfile_id:r,type:a,page:i,textMatchFilter:c}},an=()=>{const{isActiveSonar:n,lang_id:e,page:s,qualityProfile_id:r,severity:a,textMatchFilter:i,type:c}=cs(),[l,u]=o.useState(10),d=o.useRef(0),[f,X]=o.useState([]),[x,h]=o.useState(null),g=!!(e&&r),{data:D,isFetching:Ee,isLoading:Fe,isRefetching:Le,isFetched:_e}=ve({queryKey:["rules",e,r,c,n,a,s,l,i],async queryFn(){const y={severity:a,lang_id:e,isActiveSonar:n,qualityProfile_id:r,type:c},B={page:s,limit:l},{data:Q,count:z}=i?await q.getByRuleName(i,y,B):await q.getPaginatedRulesByFilter(y,B);return d.current=z,ts(z),Q},enabled:g,keepPreviousData:!0});o.useEffect(()=>{J(1)},[c,a,n,r,i]);const ue=o.useCallback(async()=>{if(!g)return;const y=D==null?void 0:D.map(({rules:m,...j})=>{var N;return{...m,...j,...Number((N=x==null?void 0:x.new)==null?void 0:N.id)===Number(j.id)?x==null?void 0:x.new:{},isActiveOriginal:j.isActive}}),Q=(y?await _.getLocalRules(y.map(({id:m})=>Number(m))):[]).reduce((m,j)=>(m[j.id]=j,m),{}),z=y==null?void 0:y.map(m=>{var j,N;return{...m,isActive:((j=Q[m.id])==null?void 0:j.newStatus)??m.isActive,description:((N=Q[m.id])==null?void 0:N.description)??m.description}});X(z)},[D,g,x]);return o.useEffect(()=>{ue()},[D,s,ue]),o.useEffect(()=>{const y=Oe().subscribeChanges(B=>h({...B}));return()=>{y.unsubscribe()}},[]),[J,u,{data:f,isFetching:Ee,isLoading:Fe,total:d.current,page:s,isFetched:_e,rowsPerPage:l,isRefetching:Le}]},ls=()=>{const[n,e]=o.useState(!1);return[o.useCallback(async r=>{e(!0);const a=await _.rulesStatus.toArray(),i=r?a.filter(({id:c})=>r[Number(c)]):a;await q.postNewStatus(i),await _.rulesStatus.clear(),await le.invalidateQueries({queryKey:["rules"]}),J(1),e(!1)},[]),n]},rn=()=>{const[n,e]=o.useState(!1);return[o.useCallback(async()=>{e(!0),await _.rulesStatus.clear(),await le.invalidateQueries({queryKey:["rules"]}),J(1),e(!1)},[]),n]},us=o.memo(function({body:e,header:s,footer:r,stickyHeader:a=!0}){return t.jsxs(xt,{sx:{paddingY:4,background:"transparent"},children:[t.jsx(Ye,{sx:{maxHeight:"80vh"},children:t.jsxs(Xe,{stickyHeader:a,children:[t.jsx(et,{children:s}),t.jsx(tt,{sx:{backgroundColor:({palette:i})=>i.mode===oe.DARK?i.grey[800]:i.grey[300]},children:e}),r&&e&&t.jsx(st,{children:r})]})}),!e&&t.jsx("div",{children:"asdsadsadsda"})]})}),fe=[{resource:"key",label:"Codigo"},{resource:"name",label:"Regla"},{resource:"newStatus",label:"Estado local"}],ds=()=>{const[n]=ls(),[e,s]=o.useState(!1),[r,a]=o.useState([]),i=o.useRef({}),[c,l]=o.useState(!1),u=o.useCallback(()=>{s(!1)},[]),d=o.useCallback(()=>{const{current:h}=i,g=Object.values(h).length?h:void 0;n(g),u()},[n,u]),f=o.useCallback(async()=>{const h=await _.getRulesToUpdate(),g=await q.getConflicts(h);if(a(g),g!=null&&g.length)return s(!0);d()},[d]),X=o.useCallback((h,g)=>{if(g.target.checked)return i.current[h]=!0;delete i.current[h]},[]),x=o.useCallback(h=>{l(h.target.checked)},[]);return t.jsxs(t.Fragment,{children:[t.jsxs(we,{onClick:f,children:[t.jsx(be,{children:t.jsx(de,{fontSize:"small"})}),t.jsx(Ce,{children:"Sincronizar"})]}),t.jsxs(nt,{onClose:u,open:e,children:[t.jsx(at,{children:"Hay conflictos"}),t.jsxs(rt,{children:[t.jsx(us,{header:t.jsxs(he,{children:[t.jsx($,{children:t.jsx(ge,{checked:c,onChange:x})}),fe.map(({label:h})=>t.jsx($,{children:h},h))]}),body:t.jsx(t.Fragment,{children:r==null?void 0:r.map(h=>t.jsxs(he,{children:[t.jsx($,{children:t.jsx(ge,{disabled:c,onChange:g=>X(h.id,g)})}),fe.map(g=>t.jsx($,{id:`${h.id}-${g.label}`,children:typeof h[g.resource]=="boolean"?h[g.resource]?"Activo":"Inactivo":h[g.resource]}))]},h.id))})}),t.jsx(it,{children:t.jsx(L,{onClick:d,startIcon:t.jsx(de,{}),children:"Sincronizar"})})]})]})]})},hs=()=>q.getAllLanguages(),gs=()=>{var r;const n=vt.useLiveQuery(()=>_.rulesStatus.toArray()),{data:e}=ve({queryKey:["languages"],queryFn:hs}),s=o.useMemo(()=>ce(e,"id","name"),[e]);return t.jsx(Mt,{icon:ne(!(n!=null&&n.length),t.jsx(Ue,{}),t.jsx(Ne,{})),textButton:t.jsx(b,{children:ne(!!(n!=null&&n.length),"Tienes cambios sin sincronizar","No hay cambios sin sincronizar")}),buttonProps:{variant:"contained"},popoverBody:t.jsx(ot,{children:e&&t.jsxs(ct,{children:[(r=n==null?void 0:n.filter(({languageId:a},i,c)=>c.findIndex(({languageId:l})=>l===a)===i))==null?void 0:r.map(({languageId:a},i)=>t.jsx(k,{direction:"row",children:t.jsx(jt,{label:s[a]})},i)),t.jsx(lt,{children:t.jsx(ds,{})})]})})})},ms=()=>{const{palette:n}=Se(),e=o.useContext(Te),{isLogged:s,user:r}=o.useContext(M),[a,i]=o.useState(null),c=o.useContext(M),l=o.useCallback(()=>e.toggleColorMode(),[e]),u=o.useCallback(({currentTarget:f})=>{i(f)},[]),d=o.useCallback(()=>{i(null)},[]);return t.jsxs(t.Fragment,{children:[t.jsx(ut,{sx:{background:({palette:f})=>`linear-gradient(90deg, ${f.primary.main} 80%, ${f.secondary.main} 100%)`},children:t.jsx(ie,{children:t.jsxs(dt,{disableGutters:!0,sx:{justifyContent:"space-between"},children:[t.jsxs(V,{sx:ps,children:[t.jsx(b,{variant:"h6",fontWeight:900,children:"Sonardash"}),t.jsx(b,{variant:"body1",children:"/ Gestión de Reglas"})]}),s&&t.jsx(gs,{}),t.jsxs(k,{direction:"row",justifyContent:"center",alignItems:"center",children:[(n==null?void 0:n.mode)===oe.DARK?t.jsx(qe,{}):t.jsx(Ve,{}),t.jsx(ht,{color:"warning",onChange:l}),s&&t.jsx(L,{sx:{borderRadius:"50%"},onClick:u,children:t.jsx(wt,{sx:{width:40,height:40},variant:"circular",children:r==null?void 0:r.email[0]})})]})]})})}),t.jsx(gt,{open:!!a,anchorEl:a,onClose:d,children:t.jsx(mt,{children:t.jsxs(we,{onClick:()=>{c.logOut(),d()},children:[t.jsx(be,{children:t.jsx(Qe,{})}),t.jsx(Ce,{children:"Log out"})]})})})]})},ps={display:"flex",justifyContent:"center",alignItems:"center",gap:1},fs="/rulesAdmin/admin.svg",ys="_heroImage_1kfgi_1",xs={heroImage:ys},js=({handleClose:n,handleOpen:e,isOpen:s,content:r})=>{const a=Se(),i=je(a.breakpoints.up("md"));return t.jsx(pt,{PaperProps:{sx:{justifyContent:"center"}},onOpen:e,onClose:n,open:s,anchor:i?"right":"bottom",children:t.jsx(ie,{sx:ws,children:r})})},ws={maxWidth:500,width:{md:"50vw"},minHeight:"50vh",display:"grid",placeContent:"center"},ae=({inputProps:n,disabled:e,id:s="password",label:r="Password"})=>{const[a,i]=o.useState(!1),c=o.useCallback(()=>{i(l=>!l)},[]);return t.jsxs(A,{disabled:e,children:[t.jsx(E,{htmlFor:s,children:r}),t.jsx(F,{id:s,type:a?"text":"password",inputProps:n,endAdornment:t.jsx(ft,{position:"end",children:t.jsx(te,{"aria-label":"toggle password visibility",onMouseDown:l=>l.preventDefault(),edge:"end",onClick:c,children:a?t.jsx(ze,{}):t.jsx($e,{})})}),label:r})]})};function bs(){const n=o.useContext(M),{enqueueSnackbar:e}=Pt();async function s(r,a){try{await n.login(r,a)}catch(i){const{message:c}=i;return e("Credenciales inválidas",{variant:"error",autoHideDuration:3e3}),c}}return s}function Cs({singUpClick:n,isSingUpAvailable:e}){const{handleSubmit:s,register:r,resetField:a}=ke(),i=bs(),[c,l]=o.useState(!1),u=o.useCallback(async({email:d,password:f})=>{l(!0),a("password"),i(d,f),l(!1)},[i,a]);return t.jsxs(k,{component:"form",onSubmit:s(u),spacing:2,p:2,children:[t.jsx(V,{display:"flex",justifyContent:"center",children:t.jsx(He,{sx:{fontSize:"10vh",borderRadius:"50%",border:"2px solid gray"}})}),t.jsxs(A,{disabled:c,children:[t.jsx(E,{htmlFor:"email",children:"Email"}),t.jsx(F,{id:"email",label:"Email",inputProps:r("email")})]}),t.jsx(ae,{disabled:c,inputProps:r("password")}),t.jsx(bt,{type:"submit",variant:"contained",disabled:c,loading:c,children:"Login"}),e&&t.jsxs(b,{align:"center",children:["¿Aún no te registras? ",t.jsx(ee,{onClick:n,children:"Sing up"})," "]})]})}const Ss=({handleLoginClick:n})=>{const[e,s]=o.useState(!1),[r,a]=o.useState(!1),{register:i,handleSubmit:c}=ke(),l=o.useContext(M),u=o.useCallback(async d=>{s(!0),await l.singUp(d),s(!1),a(!0)},[l]);return r?t.jsx(k,{children:t.jsxs(b,{children:["Revisa tu correo y haz click en el enalnce de confirmacion, si ya lo hiciste, ",t.jsx(ee,{onClick:n,children:"Logueate"})]})}):t.jsxs(k,{component:"form",onSubmit:c(u),spacing:2,children:[t.jsxs(A,{disabled:e,children:[t.jsx(E,{htmlFor:"email",children:"Email"}),t.jsx(F,{id:"email",label:"Email",inputProps:i("email")})]}),t.jsx(ae,{inputProps:i("password")}),t.jsx(ae,{id:"confirmPassword",label:"Confirm Password",inputProps:i("confirmPassword")}),t.jsxs(A,{disabled:e,children:[t.jsx(E,{htmlFor:"username",children:"Username"}),t.jsx(F,{id:"username",label:"Username",inputProps:i("username")})]}),t.jsxs(A,{disabled:e,children:[t.jsx(E,{htmlFor:"lastName",children:"Apellido"}),t.jsx(F,{id:"lastName",label:"Apellido",inputProps:i("lastName")})]}),t.jsxs(A,{disabled:e,children:[t.jsx(E,{htmlFor:"firstName",children:"Nombre"}),t.jsx(F,{id:"firstName",label:"Nombre",inputProps:i("firstName")})]}),t.jsx(L,{type:"submit",variant:"contained",children:"Sing up"}),t.jsxs(b,{align:"center",children:["¿Ya tienes cuenta? ",t.jsx(ee,{onClick:n,children:"Log in"})]})]})},vs=({isSingUpAvailable:n})=>{const[e,s]=o.useState(!1),[r,a]=o.useState(!0),i=o.useCallback((d=!0)=>()=>{s(!0),a(d)},[]),c=o.useCallback(()=>{s(!1)},[]),l=o.useCallback(()=>{a(!1)},[]),u=o.useCallback(()=>{a(!0)},[]);return t.jsxs(t.Fragment,{children:[t.jsxs(k,{direction:"row",height:"80vh",spacing:2,gap:2,alignItems:"center",justifyContent:"center",children:[t.jsx(V,{sx:ks,children:t.jsx("img",{className:xs.heroImage,src:fs,alt:"admin configuring panel"})}),t.jsxs(k,{spacing:1,width:{sm:"100%",md:"50%"},children:[t.jsx(b,{variant:"h3",component:"h1",children:"Ace config and simplify SonarQube rule administration"}),t.jsx(b,{variant:"body1",children:"Effortlessly Customize SonarQube Rules for Optimal Code Quality"}),t.jsxs(k,{spacing:2,direction:{sm:"column",md:"row"},children:[n&&t.jsx(L,{variant:"contained",onClick:i(!1),children:"Sing up"}),t.jsx(L,{variant:"outlined",onClick:i(),children:"Log in"})]})]})]}),t.jsx(js,{content:r?t.jsx(Cs,{singUpClick:l}):t.jsx(Ss,{handleLoginClick:u}),handleClose:c,handleOpen:i,isOpen:e})]})},ks={width:{xs:"0%",md:"50%"},display:{xs:"none",md:"block"}},ye=()=>t.jsx(V,{width:"100%",sx:{display:"grid",placeContent:"center"},children:t.jsx(Ct,{animation:"pulse",variant:"rectangular",width:"80vw",height:"50vh"})}),Is=o.lazy(()=>We(()=>import("./AdminPanel-21f6eb03.js"),["assets/AdminPanel-21f6eb03.js","assets/@mui/icons-material-c2086071.js","assets/vendor-b612640b.js","assets/@emotion/react-0d101b94.js","assets/@emotion/styled-6b07d811.js","assets/@reactour/tour-e24be7d6.js","assets/@tanstack/react-query-7cfe65c4.js","assets/@react-rxjs/core-1a0bb4f0.js","assets/@react-rxjs/utils-24ca515a.js","assets/@mui/material-99b79a59.js","assets/@mui/lab-cc97fd70.js","assets/use-debounce-6bf2a1da.js","assets/dayjs-c0cd33fe.js","assets/react-draggable-cc2383fd.js","assets/react-hook-form-c6612ec3.js","assets/@supabase/supabase-js-711ba96a.js","assets/dexie-3976de5d.js","assets/dexie-react-hooks-0c2ddb12.js","assets/axios-760d4776.js","assets/notistack-f220509a.js","assets/hotkeys-js-d20e5801.js"]));function Ts(){const{isLogged:n,isLoading:e}=o.useContext(M);return t.jsx(Rt,{children:t.jsx(Lt,{app:t.jsxs(t.Fragment,{children:[t.jsx(ms,{}),t.jsxs(ie,{sx:{paddingTop:12,minHeight:"100vh"},children:[e&&t.jsx(ye,{}),!n&&!e?t.jsx(vs,{}):t.jsx(o.Suspense,{fallback:t.jsx(ye,{}),children:t.jsx(Is,{})})]})]})})})}const Ps="pacifico.dev.com",Rs=({children:n})=>{const[e,s]=o.useState(!1),[r,a]=o.useState(!0);o.useEffect(()=>{I.checkAuth().then(c=>{var l;s(!!((l=c==null?void 0:c.user)!=null&&l.id))}).finally(()=>{a(!1)})},[]);const i=o.useMemo(()=>({isLogged:e,isLoading:r,user:I.user,async login(c,l){const u=await I.login(c,l);return s(!0),u},async checkAuth(c,l){return await I.checkAuth(c,l)},async singUp(c){await I.singUp(c)},async logOut(){await I.logOut(),s(!1)}}),[e,r]);return t.jsx(M.Provider,{value:i,children:n})};At("ctrl+m",n=>{n.preventDefault(),rs(!0)});window.woopra.config({domain:Ps,outgoing_tracking:!0,download_tracking:!0,click_tracking:!0}),window.woopra.track();se.createRoot(document.getElementById("root")).render(t.jsx(Ke.StrictMode,{children:t.jsx(Ot,{steps:[{selector:".language",content:"Selecciona el lenguaje de programación del cual deseas consultar reglas."},{selector:".mainFilters",content:"Ahora procede a seleccionar el perfil a consultar"},{selector:".actualState",content:"Este es el estado actual de la regla en Sonarqube. Las reglas activas son las que analizan los repositorios."},{selector:".proposedState",content:"Aquí podrás proponer si una regla debe estar activada o desactivada, recuerda que tu propuesta no se verá reflejada en SonarQube inmediatamente."},{selector:".dragableMenu",content:t.jsxs(b,{children:["Las opciones de descarga y guardado se encuentran en este botón. Si no lo encuentras rápido, ubícalo con ",t.jsx("kbd",{children:"ctrl"})," +"," ",t.jsx("kbd",{children:"m"}),", ¡también lo puedes mover por toda la pantalla!"]})}],children:t.jsx(Rs,{children:t.jsx(Tt,{client:le,children:t.jsx(Ts,{})})})})}));export{M as A,oe as C,Ks as D,ds as S,tn as a,Xs as b,en as c,Ys as d,_ as e,q as f,an as g,us as h,Oe as i,rn as j,sn as k,Xt as l,Mt as m,nn as n,Js as p,Zs as s,$t as u,Ws as v};
